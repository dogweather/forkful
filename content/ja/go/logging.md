---
title:                "ロギング"
date:                  2024-01-26T01:04:23.499058-07:00
model:                 gpt-4-1106-preview
simple_title:         "ロギング"

category:             "Go"
tag:                  "Good Coding Practices"
editURL:              "https://github.com/dogweather/forkful/blob/master/content/ja/go/logging.md"
---

{{< edit_this_page >}}

## 何となぜ？
ログとは、アプリケーションのイベント、状態、データフローを記録することです。プログラマーはバグの診断、パフォーマンスの監視、そしてアプリの運用状態を追跡するためにこれを行います。ほとんどの場合、これは飛行機のブラックボックスに相当するソフトウェア版と言えます。

## どうやって：
Goでのログ取りは、標準ライブラリの`log`パッケージから、`logrus`や`zap`のようなサードパーティのライブラリに至るまで、複数の方法で対応できます。以下は組み込みの`log`パッケージを使用した簡単な例です：

```Go
package main

import (
	"log"
	"os"
)

func main() {
	// ログファイルを作成する
	logFile, err := os.OpenFile("app.log", os.O_CREATE|os.O_APPEND|os.O_WRONLY, 0666)
	if err != nil {
		log.Fatal(err)
	}
	defer logFile.Close()

	// ログ出力をファイルに設定する
	log.SetOutput(logFile)

	// イベントをログに記録する
	log.Println("アプリケーションの起動...")
	// ... アプリケーションのロジックはここに ...
	log.Println("アプリケーションが正常に終了しました。")
}
```

このコードを実行すると、ターミナルには何も表示されません。なぜなら、全て`app.log`に出力されるからです。そのログファイルを覗いてみると、以下のような内容が見つかります：

```
2023/01/02 15:04:05 アプリケーションの起動...
2023/01/02 15:05:01 アプリケーションが正常に終了しました。
```

## 詳細な解説
プログラミングにおけるログは、エンジニアが文字通りハードウェアに挟まった虫（正確には蛾）を発見し記録するところから始まりました。現代になって、ログは複雑なシステム内で何が起こっているかを理解する洗練された方法へと進化しています。

Goの`log`パッケージは非常にシンプルですが、基本的なアプリケーションには十分なことがあります。しかし、現代の分散システムの文脈や、ログ出力をより繊細に制御する必要があるとき（例えば、重大度の異なるレベルなど）、より堅牢なソリューションに目を向けるべきかもしれません。

`logrus`や`zap`のようなサードパーティのログライブラリは、構造化ログを提供します。これにより、JSONのような複雑なデータ型をログ記録することができ、特にELKスタックやSplunkのようなログ管理システムを併用する際に、ログを解釈しやすくなります。

ログ戦略の実装を検討する際には、パフォーマンスへの影響も重要です。高パフォーマンスのログライブラリは、アプリケーションのスループットやレイテンシーへの影響を減少させるように最適化されています。例えば、`zap`はその超高速で割当ての少ない設計を売りにしており、リアルタイムシステムにとって重要になることがあります。

さまざまなライブラリに加え、ログの形式や標準についても注目に値します。JSONのような構造化ログ形式は、ログ処理システムと併用した場合に非常に強力になり得ます。一方で、プレーンテキストのログは人間が読むには適していますが、プログラムで解析するのはより困難です。

## 関連情報
Goのログ機能をさらに深く掘り下げるために、これらのリソースが役立つかもしれません：

- Goブログのログについて: https://blog.golang.org/logging
- `logrus`、Goのための構造化されたロガー: https://github.com/sirupsen/logrus
- `zap`、高速で構造化されたレベルロガー: https://github.com/uber-go/zap
- ログ分析のためのELKスタック（Elasticsearch、Logstash、Kibana）: https://www.elastic.co/what-is/elk-stack
- Goのログライブラリ比較: https://www.loggly.com/blog/benchmarking-5-popular-golang-logging-libraries/
