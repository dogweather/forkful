---
changelog:
- 2024-02-01, gpt-4-0125-preview, translated from English
date: 2024-02-01 21:53:14.797240-07:00
description: "\u0417\u0430\u0432\u0430\u043D\u0442\u0430\u0436\u0435\u043D\u043D\u044F\
  \ \u0432\u0435\u0431-\u0441\u0442\u043E\u0440\u0456\u043D\u043A\u0438 \u0437\u0430\
  \ \u0434\u043E\u043F\u043E\u043C\u043E\u0433\u043E\u044E Google Apps Script \u043F\
  \u0435\u0440\u0435\u0434\u0431\u0430\u0447\u0430\u0454 \u043E\u0442\u0440\u0438\u043C\
  \u0430\u043D\u043D\u044F \u0432\u043C\u0456\u0441\u0442\u0443 \u0432\u0435\u0431\
  -\u0441\u0442\u043E\u0440\u0456\u043D\u043A\u0438 \u0447\u0435\u0440\u0435\u0437\
  \ HTML \u0434\u043B\u044F \u0440\u0456\u0437\u043D\u043E\u043C\u0430\u043D\u0456\
  \u0442\u043D\u0438\u0445 \u0446\u0456\u043B\u0435\u0439, \u0442\u0430\u043A\u0438\
  \u0445 \u044F\u043A \u0432\u0435\u0431-\u2026"
lastmod: '2024-02-25T18:49:46.066861-07:00'
model: gpt-4-0125-preview
summary: "\u0417\u0430\u0432\u0430\u043D\u0442\u0430\u0436\u0435\u043D\u043D\u044F\
  \ \u0432\u0435\u0431-\u0441\u0442\u043E\u0440\u0456\u043D\u043A\u0438 \u0437\u0430\
  \ \u0434\u043E\u043F\u043E\u043C\u043E\u0433\u043E\u044E Google Apps Script \u043F\
  \u0435\u0440\u0435\u0434\u0431\u0430\u0447\u0430\u0454 \u043E\u0442\u0440\u0438\u043C\
  \u0430\u043D\u043D\u044F \u0432\u043C\u0456\u0441\u0442\u0443 \u0432\u0435\u0431\
  -\u0441\u0442\u043E\u0440\u0456\u043D\u043A\u0438 \u0447\u0435\u0440\u0435\u0437\
  \ HTML \u0434\u043B\u044F \u0440\u0456\u0437\u043D\u043E\u043C\u0430\u043D\u0456\
  \u0442\u043D\u0438\u0445 \u0446\u0456\u043B\u0435\u0439, \u0442\u0430\u043A\u0438\
  \u0445 \u044F\u043A \u0432\u0435\u0431-\u2026"
title: "\u0417\u0430\u0432\u0430\u043D\u0442\u0430\u0436\u0435\u043D\u043D\u044F \u0432\
  \u0435\u0431-\u0441\u0442\u043E\u0440\u0456\u043D\u043A\u0438"
---

{{< edit_this_page >}}

## Що і Чому?

Завантаження веб-сторінки за допомогою Google Apps Script передбачає отримання вмісту веб-сторінки через HTML для різноманітних цілей, таких як веб-скрапінг, екстракція даних або моніторинг змін. Програмісти вибирають цю операцію для автоматизації збору даних або інтеграційних завдань, мінімізуючи ручні зусилля та забезпечуючи обробку даних в реальному часі.

## Як це зробити:

У Google Apps Script служба `UrlFetchApp` є ключовою для завантаження веб-вмісту. Нижче наведено поетапний посібник та простий приклад, який демонструє, як отримати вміст HTML сторінки та зареєструвати його:

1. **Основна операція завантаження:**

```javascript
function downloadWebPage() {
  var url = "http://example.com";
  var response = UrlFetchApp.fetch(url);
  var content = response.getContentText();
  Logger.log(content);
}
```

- Цей код отримує HTML вміст example.com та реєструє його. Це просте демонстрування отримання вихідного коду веб-сторінки без будь-яких додаткових параметрів.

2. **Обробка переадресацій та HTTPS:**

Для HTTPS або обробки переадресацій код залишається майже таким самим, але варто розглянути реалізацію обробки помилок або специфічні опції для переадресацій:

```javascript
function downloadSecureWebPage() {
  var options = {
    'followRedirects': true, // Автоматично слідувати за переадресаціями
    'muteHttpExceptions': true // Придушити можливі виключення для їх красивого оброблення
  };
  
  var url = "https://example.com";
  var response = UrlFetchApp.fetch(url, options);
  Logger.log(response.getContentText());
}
```

3. **Ліміти частоти та квоти:**

Будьте уважними до квот Google Apps Script; інтенсивне використання може вимагати обробки помилок для обмежень частоти.

## Поглиблений огляд

Історично, завантаження та маніпуляція веб-вмістом починалися з простих HTTP запитів, які істотно еволюціонували з появою скриптових мов. Google Apps Script дозволяє просто виконувати такі завдання в екосистемі G Suite, використовуючи міцну інфраструктуру Google. Служба `UrlFetchApp` є ключовим елементом цієї функціональності, упаковуючи складні HTTP/S запити в простіший інтерфейс на рівні додатків.

Незважаючи на зручність, Google Apps Script може не завжди бути кращим інструментом для інтенсивного веб-скрапінгу або коли потрібна складна постобробка отриманих даних через обмеження часу виконання та квоти, накладені Google. У таких випадках, спеціалізовані рамки для веб-скрапінгу або мови, розроблені для асинхронних I/O операцій, такі як Node.js з бібліотеками на кшталт Puppeteer або Cheerio, можуть пропонувати більше гнучкості та потужності.

Більше того, хоча Google Apps Script є відмінним інструментом для інтеграції з Google службами (такими як Sheets, Docs та Drive) та виконання операцій легкого збору даних, важливо пам'ятати про обмеження середовища виконання. Для інтенсивних завдань розгляньте використання Google Cloud Functions або розширених служб Apps Script з зовнішніми ресурсами обробки.
