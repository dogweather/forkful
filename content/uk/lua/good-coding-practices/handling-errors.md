---
date: 2024-01-26 00:55:16.351376-07:00
description: "\u042F\u043A \u0446\u0435 \u0440\u043E\u0431\u0438\u0442\u0438: Lua\
  \ \u0432\u0438\u043A\u043E\u0440\u0438\u0441\u0442\u043E\u0432\u0443\u0454 \u0434\
  \u0432\u0456 \u043E\u0441\u043D\u043E\u0432\u043D\u0456 \u0444\u0443\u043D\u043A\
  \u0446\u0456\u0457 \u0434\u043B\u044F \u043E\u0431\u0440\u043E\u0431\u043A\u0438\
  \ \u043F\u043E\u043C\u0438\u043B\u043E\u043A: `pcall` \u0442\u0430 `xpcall`. \u041E\
  \u0441\u044C \u044F\u043A \u0432\u043E\u043D\u0438 \u0432\u0438\u043A\u043E\u0440\
  \u0438\u0441\u0442\u043E\u0432\u0443\u044E\u0442\u044C\u0441\u044F."
lastmod: '2024-03-13T22:44:49.512824-06:00'
model: gpt-4-1106-preview
summary: "Lua \u0432\u0438\u043A\u043E\u0440\u0438\u0441\u0442\u043E\u0432\u0443\u0454\
  \ \u0434\u0432\u0456 \u043E\u0441\u043D\u043E\u0432\u043D\u0456 \u0444\u0443\u043D\
  \u043A\u0446\u0456\u0457 \u0434\u043B\u044F \u043E\u0431\u0440\u043E\u0431\u043A\
  \u0438 \u043F\u043E\u043C\u0438\u043B\u043E\u043A."
title: "\u041E\u0431\u0440\u043E\u0431\u043A\u0430 \u043F\u043E\u043C\u0438\u043B\u043E\
  \u043A"
weight: 16
---

## Як це робити:
Lua використовує дві основні функції для обробки помилок: `pcall` та `xpcall`. Ось як вони використовуються:

```lua
function might_fail()
    if math.random() > 0.5 then
        error("Ой! Щось пішло не так.")
    else
        print("Все добре!")
    end
end

-- Використання pcall
local success, errorMessage = pcall(might_fail)

if success then
    print("Успіх!")
else
    print("Помилка перехоплена:", errorMessage)
end

-- Використання xpcall з обробником помилок
function myErrorHandler(err)
    print("Обробник помилок каже:", err)
end

local status = xpcall(might_fail, myErrorHandler)
print("Чи був виклик успішний?", status)
```

Приклад виводу може бути:

```
Помилка перехоплена: Ой! Щось пішло не так.
Обробник помилок каже: Ой! Щось пішло не так.
Чи був виклик успішний? false
```
Або, якщо помилки не відбувається:
```
Все добре!
Успіх!
Все добре!
Чи був виклик успішний? true
```

## Поглиблено
Обробка помилок або "керування винятками" раніше не завжди використовувалася. Ранні програми часто «падали». Разом із розвитком програмування зросла й потреба у стабільності. Підхід Lua до обробки помилок є простим порівняно з деякими іншими мовами. Немає блоків `try/catch`, тільки `pcall` та `xpcall`. Перший захищає виклик функції, повертаючи статус і будь-яку помилку. Другий додає функцію обробки помилок, корисну для власного очищення або логування.

Альтернативою у Lua є використання `assert`, яке може виконувати подібну роль, викидаючи помилку, якщо умова є неправдивою. Але це не так гнучко, як `pcall` для складних сценаріїв обробки помилок.

Внутрішньо, `pcall` і `xpcall` працюють, створюючи "захищене середовище" для виконання функції. Якщо з'являється помилка, середовище її зловлює і може або вирішити прямо там, або передати її назад програмі для обробки.

## Дивіться також
- Книга "Програмування на Lua" (третє видання), доступна на сайті https://www.lua.org/pil/ для детального ознайомлення з обробкою помилок (Розділ 8.4).
- Офіційний посібник Lua 5.4: https://www.lua.org/manual/5.4/ - для найбільш актуальної інформації про функції обробки помилок Lua.
- Вікі користувачів Lua про обробку помилок: http://lua-users.org/wiki/ErrorHandling – для інсайтів спільноти та шаблонів.
