---
changelog:
- 2024-02-01, gpt-4-0125-preview, translated from English
date: 2024-02-01 21:52:47.141698-07:00
description: "\u042F\u043A \u0446\u0435 \u0437\u0440\u043E\u0431\u0438\u0442\u0438\
  : \u0423 VBA \u0441\u0442\u0432\u043E\u0440\u0435\u043D\u043D\u044F \u0442\u0438\
  \u043C\u0447\u0430\u0441\u043E\u0432\u043E\u0433\u043E \u0444\u0430\u0439\u043B\u0443\
  \ \u043C\u043E\u0436\u043D\u0430 \u0434\u043E\u0441\u044F\u0433\u0442\u0438 \u0437\
  \u0430 \u0434\u043E\u043F\u043E\u043C\u043E\u0433\u043E\u044E `FileSystemObject`,\
  \ \u0434\u043E\u0441\u0442\u0443\u043F\u043D\u043E\u0433\u043E \u0443 \u0431\u0456\
  \u0431\u043B\u0456\u043E\u0442\u0435\u0446\u0456 Microsoft Scripting Runtime. \u0426\
  \u0435\u0439\u2026"
lastmod: '2024-03-13T22:44:49.043361-06:00'
model: gpt-4-0125-preview
summary: "\u0423 VBA \u0441\u0442\u0432\u043E\u0440\u0435\u043D\u043D\u044F \u0442\
  \u0438\u043C\u0447\u0430\u0441\u043E\u0432\u043E\u0433\u043E \u0444\u0430\u0439\u043B\
  \u0443 \u043C\u043E\u0436\u043D\u0430 \u0434\u043E\u0441\u044F\u0433\u0442\u0438\
  \ \u0437\u0430 \u0434\u043E\u043F\u043E\u043C\u043E\u0433\u043E\u044E `FileSystemObject`,\
  \ \u0434\u043E\u0441\u0442\u0443\u043F\u043D\u043E\u0433\u043E \u0443 \u0431\u0456\
  \u0431\u043B\u0456\u043E\u0442\u0435\u0446\u0456 Microsoft Scripting Runtime."
title: "\u0421\u0442\u0432\u043E\u0440\u0435\u043D\u043D\u044F \u0442\u0438\u043C\u0447\
  \u0430\u0441\u043E\u0432\u043E\u0433\u043E \u0444\u0430\u0439\u043B\u0443"
weight: 21
---

## Як це зробити:
У VBA створення тимчасового файлу можна досягти за допомогою `FileSystemObject`, доступного у бібліотеці Microsoft Scripting Runtime. Цей об'єкт надає методи для створення, читання, запису та видалення файлів і папок. Ось поетапний путівник зі створення тимчасового файлу:

1. **Увімкнення Microsoft Scripting Runtime**: Спершу переконайтесь, що посилання на Microsoft Scripting Runtime увімкнено в вашому середовищі VBA. Перейдіть до Tools > References у редакторі VBA та встановіть галочку на "Microsoft Scripting Runtime".

2. **Створення тимчасового файлу**: Наведений нижче код VBA демонструє, як створити тимчасовий файл у стандартній тимчасовій папці.

```vb
Sub CreateTemporaryFile()
    Dim fso As Object
    Dim tmpFile As Object
    
    ' Створення FileSystemObject
    Set fso = CreateObject("Scripting.FileSystemObject")
    
    ' Отримання шляху до тимчасової папки
    Dim tempFolder As String
    tempFolder = fso.GetSpecialFolder(2) ' 2 вказує на тимчасову папку
    
    ' Створення тимчасового файлу та отримання до нього посилання
    Set tmpFile = fso.CreateTextFile(tempFolder & "\myTempFile.txt", True)
    
    ' Запис щось у файл
    tmpFile.WriteLine "Це тест."
    
    ' Закриття файлу
    tmpFile.Close
    
    ' Опціонально, друк шляху для посилання
    Debug.Print "Тимчасовий файл створено за адресою: " & tempFolder & "\myTempFile.txt"
End Sub
```

3. **Приклад виводу**: Коли ви запустите вищезгаданий код, він створить тимчасовий файл під назвою `myTempFile.txt` у тимчасовій папці та запише до нього рядок тексту. Якщо у вас відкрите вікно Immediate (`Ctrl + G` у редакторі VBA), ви побачите:
   
```
Тимчасовий файл створено за адресою: C:\Users\[ВашКористувач]\AppData\Local\Temp\myTempFile.txt
```

## Поглиблений погляд
Показаний метод використовує `FileSystemObject` (FSO), частина Microsoft Scripting Runtime. FSO - це потужний інструмент для маніпуляцій з файловою системою, введений з Visual Basic Scripting Edition. Попри свій вік, він широко використовується в VBA за його простоту та широкий функціонал.

Створення тимчасових файлів відіграє важливу роль у багатьох програмувальних та скриптових завданнях, надаючи пісочницю для тестування або робоче середовище для процесів, які не вимагають постійного зберігання. Однак, розробники повинні обережно обійтися з цими файлами, переконавшись, що вони видалені або очищені, коли вони більше не потрібні, для запобігання випадкового витоку даних або непотрібного споживання дискового простору.

Хоча VBA надає нативні методи для роботи з файлами та папками, `FileSystemObject` пропонує більш об'єктно-орієнтований підхід, який може бути більш знайомим програмістам з інших мов. Однак, новіші технології або мови можуть пропонувати більш міцні або безпечні методи обробки тимчасових файлів, такі як використання структур даних у пам'яті або спеціалізованих бібліотек тимчасових файлів в середовищах на кшталт Python або .NET. У таких випадках, хоча VBA може добре служити для швидких завдань або інтеграції в межах додатків Office, рекомендується розглянути альтернативи для більш обширних або безпеко-чутливих застосунків.
