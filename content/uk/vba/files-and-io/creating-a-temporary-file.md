---
changelog:
- 2024-02-01, gpt-4-0125-preview, translated from English
date: 2024-02-01 21:52:47.141698-07:00
description: "\u0421\u0442\u0432\u043E\u0440\u0435\u043D\u043D\u044F \u0442\u0438\u043C\
  \u0447\u0430\u0441\u043E\u0432\u043E\u0433\u043E \u0444\u0430\u0439\u043B\u0443\
  \ \u0432 Visual Basic for Applications (VBA) \u0432\u043A\u043B\u044E\u0447\u0430\
  \u0454 \u043F\u0440\u043E\u0433\u0440\u0430\u043C\u043D\u0435 \u0433\u0435\u043D\
  \u0435\u0440\u0443\u0432\u0430\u043D\u043D\u044F \u0444\u0430\u0439\u043B\u0443\
  \ \u0434\u043B\u044F \u043A\u043E\u0440\u043E\u0442\u043A\u043E\u0447\u0430\u0441\
  \u043D\u043E\u0433\u043E \u0432\u0438\u043A\u043E\u0440\u0438\u0441\u0442\u0430\u043D\
  \u043D\u044F, \u0437\u0430\u0437\u0432\u0438\u0447\u0430\u0439 \u0434\u043B\u044F\
  \u2026"
lastmod: '2024-02-25T18:49:46.527802-07:00'
model: gpt-4-0125-preview
summary: "\u0421\u0442\u0432\u043E\u0440\u0435\u043D\u043D\u044F \u0442\u0438\u043C\
  \u0447\u0430\u0441\u043E\u0432\u043E\u0433\u043E \u0444\u0430\u0439\u043B\u0443\
  \ \u0432 Visual Basic for Applications (VBA) \u0432\u043A\u043B\u044E\u0447\u0430\
  \u0454 \u043F\u0440\u043E\u0433\u0440\u0430\u043C\u043D\u0435 \u0433\u0435\u043D\
  \u0435\u0440\u0443\u0432\u0430\u043D\u043D\u044F \u0444\u0430\u0439\u043B\u0443\
  \ \u0434\u043B\u044F \u043A\u043E\u0440\u043E\u0442\u043A\u043E\u0447\u0430\u0441\
  \u043D\u043E\u0433\u043E \u0432\u0438\u043A\u043E\u0440\u0438\u0441\u0442\u0430\u043D\
  \u043D\u044F, \u0437\u0430\u0437\u0432\u0438\u0447\u0430\u0439 \u0434\u043B\u044F\
  \u2026"
title: "\u0421\u0442\u0432\u043E\u0440\u0435\u043D\u043D\u044F \u0442\u0438\u043C\u0447\
  \u0430\u0441\u043E\u0432\u043E\u0433\u043E \u0444\u0430\u0439\u043B\u0443"
---

{{< edit_this_page >}}

## Що і чому?

Створення тимчасового файлу в Visual Basic for Applications (VBA) включає програмне генерування файлу для короткочасного використання, зазвичай для обробки даних або як буфер у завданнях автоматизації. Програмісти роблять це для управління даними, які не потребують довгострокового зберігання, зменшуючи скупченість та забезпечуючи ефективність використання пам'яті.

## Як це зробити:

У VBA створення тимчасового файлу можна досягти за допомогою `FileSystemObject`, доступного у бібліотеці Microsoft Scripting Runtime. Цей об'єкт надає методи для створення, читання, запису та видалення файлів і папок. Ось поетапний путівник зі створення тимчасового файлу:

1. **Увімкнення Microsoft Scripting Runtime**: Спершу переконайтесь, що посилання на Microsoft Scripting Runtime увімкнено в вашому середовищі VBA. Перейдіть до Tools > References у редакторі VBA та встановіть галочку на "Microsoft Scripting Runtime".

2. **Створення тимчасового файлу**: Наведений нижче код VBA демонструє, як створити тимчасовий файл у стандартній тимчасовій папці.

```vb
Sub CreateTemporaryFile()
    Dim fso As Object
    Dim tmpFile As Object
    
    ' Створення FileSystemObject
    Set fso = CreateObject("Scripting.FileSystemObject")
    
    ' Отримання шляху до тимчасової папки
    Dim tempFolder As String
    tempFolder = fso.GetSpecialFolder(2) ' 2 вказує на тимчасову папку
    
    ' Створення тимчасового файлу та отримання до нього посилання
    Set tmpFile = fso.CreateTextFile(tempFolder & "\myTempFile.txt", True)
    
    ' Запис щось у файл
    tmpFile.WriteLine "Це тест."
    
    ' Закриття файлу
    tmpFile.Close
    
    ' Опціонально, друк шляху для посилання
    Debug.Print "Тимчасовий файл створено за адресою: " & tempFolder & "\myTempFile.txt"
End Sub
```

3. **Приклад виводу**: Коли ви запустите вищезгаданий код, він створить тимчасовий файл під назвою `myTempFile.txt` у тимчасовій папці та запише до нього рядок тексту. Якщо у вас відкрите вікно Immediate (`Ctrl + G` у редакторі VBA), ви побачите:
   
```
Тимчасовий файл створено за адресою: C:\Users\[ВашКористувач]\AppData\Local\Temp\myTempFile.txt
```

## Поглиблений погляд

Показаний метод використовує `FileSystemObject` (FSO), частина Microsoft Scripting Runtime. FSO - це потужний інструмент для маніпуляцій з файловою системою, введений з Visual Basic Scripting Edition. Попри свій вік, він широко використовується в VBA за його простоту та широкий функціонал.

Створення тимчасових файлів відіграє важливу роль у багатьох програмувальних та скриптових завданнях, надаючи пісочницю для тестування або робоче середовище для процесів, які не вимагають постійного зберігання. Однак, розробники повинні обережно обійтися з цими файлами, переконавшись, що вони видалені або очищені, коли вони більше не потрібні, для запобігання випадкового витоку даних або непотрібного споживання дискового простору.

Хоча VBA надає нативні методи для роботи з файлами та папками, `FileSystemObject` пропонує більш об'єктно-орієнтований підхід, який може бути більш знайомим програмістам з інших мов. Однак, новіші технології або мови можуть пропонувати більш міцні або безпечні методи обробки тимчасових файлів, такі як використання структур даних у пам'яті або спеціалізованих бібліотек тимчасових файлів в середовищах на кшталт Python або .NET. У таких випадках, хоча VBA може добре служити для швидких завдань або інтеграції в межах додатків Office, рекомендується розглянути альтернативи для більш обширних або безпеко-чутливих застосунків.
