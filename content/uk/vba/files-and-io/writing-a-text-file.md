---
changelog:
- 2024-02-01, gpt-4-0125-preview, translated from English
date: 2024-02-01 22:09:19.499376-07:00
description: "\u0421\u0442\u0432\u043E\u0440\u0435\u043D\u043D\u044F \u0442\u0435\u043A\
  \u0441\u0442\u043E\u0432\u043E\u0433\u043E \u0444\u0430\u0439\u043B\u0443 \u0432\
  \ \u043C\u043E\u0432\u0456 \u043F\u0440\u043E\u0433\u0440\u0430\u043C\u0443\u0432\
  \u0430\u043D\u043D\u044F Visual Basic for Applications (VBA) \u0432\u043A\u043B\u044E\
  \u0447\u0430\u0454 \u0441\u0442\u0432\u043E\u0440\u0435\u043D\u043D\u044F, \u0437\
  \u043C\u0456\u043D\u0443 \u0430\u0431\u043E \u0434\u043E\u0434\u0430\u0432\u0430\
  \u043D\u043D\u044F \u0442\u0435\u043A\u0441\u0442\u043E\u0432\u0438\u0445 \u0434\
  \u0430\u043D\u0438\u0445 \u0434\u043E \u0444\u0430\u0439\u043B\u0456\u0432, \u0449\
  \u043E \u0454\u2026"
lastmod: '2024-03-13T22:44:49.041654-06:00'
model: gpt-4-0125-preview
summary: "\u0421\u0442\u0432\u043E\u0440\u0435\u043D\u043D\u044F \u0442\u0435\u043A\
  \u0441\u0442\u043E\u0432\u043E\u0433\u043E \u0444\u0430\u0439\u043B\u0443 \u0432\
  \ \u043C\u043E\u0432\u0456 \u043F\u0440\u043E\u0433\u0440\u0430\u043C\u0443\u0432\
  \u0430\u043D\u043D\u044F Visual Basic for Applications (VBA) \u0432\u043A\u043B\u044E\
  \u0447\u0430\u0454 \u0441\u0442\u0432\u043E\u0440\u0435\u043D\u043D\u044F, \u0437\
  \u043C\u0456\u043D\u0443 \u0430\u0431\u043E \u0434\u043E\u0434\u0430\u0432\u0430\
  \u043D\u043D\u044F \u0442\u0435\u043A\u0441\u0442\u043E\u0432\u0438\u0445 \u0434\
  \u0430\u043D\u0438\u0445 \u0434\u043E \u0444\u0430\u0439\u043B\u0456\u0432, \u0449\
  \u043E \u0454\u2026"
title: "\u041D\u0430\u043F\u0438\u0441\u0430\u043D\u043D\u044F \u0442\u0435\u043A\u0441\
  \u0442\u043E\u0432\u043E\u0433\u043E \u0444\u0430\u0439\u043B\u0443"
weight: 24
---

## Що і Чому?

Створення текстового файлу в мові програмування Visual Basic for Applications (VBA) включає створення, зміну або додавання текстових даних до файлів, що є фундаментальним завданням для зберігання результатів, ведення логів або взаємодії з іншими програмами. Програмісти використовують цю функціональність для автоматизації звітності, експорту даних або генерації файлів конфігурації в екосистемі Microsoft Office.

## Як це зробити:

VBA пропонує кілька способів запису у файл, але один з найпростіших способів - використання `FileSystemObject`. Ось поетапне керівництво зі створення простого текстового файлу та запису даних до нього:

1. **Підключення Microsoft Scripting Runtime**: Спочатку, переконайтеся, що ваш редактор VBA має доступ до `FileSystemObject`. Перейдіть в меню Tools > References у редакторі VBA та виберіть "Microsoft Scripting Runtime."

2. **Створення текстового файлу**: Наступний код VBA демонструє, як створити текстовий файл і записати в нього рядок тексту.

```vb
Sub WriteToFile()
    Dim fso As FileSystemObject
    Set fso = New FileSystemObject
    
    Dim textFile As Object
    ' Параметри CreateTextFile: (Ім'яФайлу, Перезапис, Unicode)
    Set textFile = fso.CreateTextFile("C:\yourPath\example.txt", True, False)
    
    ' Запис рядка тексту
    textFile.WriteLine "Hello, VBA!"
    
    ' Закриття файлу
    textFile.Close
End Sub
```

Цей скрипт створює (або перезаписує, якщо він уже існує) файл під назвою `example.txt` у вказаній директорії та записує в нього "Hello, VBA!" перед закриттям файлу для збереження змін.

3. **Приклад результату**:

Після запуску цього VBA скрипту ви знайдете файл під назвою `example.txt` з наступним змістом:

```
Hello, VBA!
```

## Поглиблено:

`FileSystemObject` (FSO), який є частиною бібліотеки Microsoft Scripting Runtime, надає багатий набір властивостей та методів для роботи з файлами, що виходить за межі традиційного управління файлами в VBA (наприклад, `Open`, `Print` #, `Write` #). Крім роботи з файлами, FSO також може маніпулювати папками та дисками, роблячи його потужним інструментом для операцій з файловою системою у VBA.

Варто зазначити, однак, що хоча FSO представляє більш сучасний підхід до роботи з файлами у VBA, він може вносити накладні витрати для простих завдань порівняно з рідними командами обробки файлів VBA. Більше того, оскільки FSO є частиною зовнішньої бібліотеки, переносимість та сумісність з іншими системами (наприклад, попередні версії Office, Office для Mac) можуть бути проблемами.

У контекстах, де критично важливі продуктивність, сумісність або мінімізація зовнішніх залежностей, програмісти можуть розглянути використання вбудованих методів роботи з файлами в VBA. Однак, для більш складних операцій або при роботі в середовищі, де ці занепокоєння мінімізовані (наприклад, у контрольованому корпоративному середовищі), переваги FileSystemObject часто перевищують його недоліки.
