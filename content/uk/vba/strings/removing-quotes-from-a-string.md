---
changelog:
- 2024-02-01, gpt-4-0125-preview, translated from English
date: 2024-02-01 22:00:59.539951-07:00
description: "\u0412\u0438\u0434\u0430\u043B\u0435\u043D\u043D\u044F \u043B\u0430\u043F\
  \u043E\u043A \u0437 \u0440\u044F\u0434\u043A\u0430 \u0443 VBA \u043F\u0435\u0440\
  \u0435\u0434\u0431\u0430\u0447\u0430\u0454 \u0443\u0441\u0443\u043D\u0435\u043D\u043D\
  \u044F \u043E\u0434\u0438\u043D\u043E\u0447\u043D\u0438\u0445 (`'`) \u0430\u0431\
  \u043E \u043F\u043E\u0434\u0432\u0456\u0439\u043D\u0438\u0445 (`\"`) \u043B\u0430\
  \u043F\u043E\u043A, \u044F\u043A\u0456 \u043C\u043E\u0436\u0443\u0442\u044C \u043E\
  \u0442\u043E\u0447\u0443\u0432\u0430\u0442\u0438 \u0430\u0431\u043E \u0431\u0443\
  \u0442\u0438 \u0432\u0431\u0443\u0434\u043E\u0432\u0430\u043D\u0438\u043C\u0438\
  \ \u0432 \u0440\u044F\u0434\u043E\u043A. \u0426\u044F\u2026"
lastmod: '2024-03-13T22:44:48.988104-06:00'
model: gpt-4-0125-preview
summary: "\u0412\u0438\u0434\u0430\u043B\u0435\u043D\u043D\u044F \u043B\u0430\u043F\
  \u043E\u043A \u0437 \u0440\u044F\u0434\u043A\u0430 \u0443 VBA \u043F\u0435\u0440\
  \u0435\u0434\u0431\u0430\u0447\u0430\u0454 \u0443\u0441\u0443\u043D\u0435\u043D\u043D\
  \u044F \u043E\u0434\u0438\u043D\u043E\u0447\u043D\u0438\u0445 (`'`) \u0430\u0431\
  \u043E \u043F\u043E\u0434\u0432\u0456\u0439\u043D\u0438\u0445 (`\"`) \u043B\u0430\
  \u043F\u043E\u043A, \u044F\u043A\u0456 \u043C\u043E\u0436\u0443\u0442\u044C \u043E\
  \u0442\u043E\u0447\u0443\u0432\u0430\u0442\u0438 \u0430\u0431\u043E \u0431\u0443\
  \u0442\u0438 \u0432\u0431\u0443\u0434\u043E\u0432\u0430\u043D\u0438\u043C\u0438\
  \ \u0432 \u0440\u044F\u0434\u043E\u043A. \u0426\u044F\u2026"
title: "\u0412\u0438\u0434\u0430\u043B\u0435\u043D\u043D\u044F \u043B\u0430\u043F\u043E\
  \u043A \u0437 \u0440\u044F\u0434\u043A\u0430"
---

{{< edit_this_page >}}

## Що і чому?

Видалення лапок з рядка у VBA передбачає усунення одиночних (`'`) або подвійних (`"`) лапок, які можуть оточувати або бути вбудованими в рядок. Ця операція є важливою для очищення даних, забезпечуючи коректне форматування рядків для запитів до бази даних, розбору JSON, або просто з міркувань естетики чи консистентності в інтерфейсі програми.

## Як?

У VBA є кілька підходів до видалення лапок з рядка. Ось простий приклад використання функції `Replace`, яка шукає конкретний підрядок (у цьому випадку, лапку) в рядку та замінює його іншим підрядком (пустим рядком, якщо виконується видалення).

```basic
Sub RemoveQuotesExample()
    Dim originalString As String
    originalString = "'This' is a ""test"" string."
    
    ' Видалити одинарні лапки
    originalString = Replace(originalString, "'", "")
    
    ' Видалити подвійні лапки
    originalString = Replace(originalString, Chr(34), "")
    
    Debug.Print originalString 'Вивід: This is a test string.
End Sub
```

Зауважте, що для подвійних лапок ми використовуємо `Chr(34)`, тому що подвійна лапка є символом ASCII з номером 34. Це необхідно, оскільки подвійні лапки також використовуються для позначення літеральних рядків у VBA.

Для більш тонких сценаріїв, де лапки можуть бути частиною необхідного форматування (наприклад, всередині слова в лапках), може знадобитись більш складна логіка, можливо, з використанням Regex або розбору символ за символом.

## Поглиблений огляд

VBA, будучи основним засобом автоматизації завдань у пакеті Microsoft Office, пропонує багатий набір функцій для маніпулювання рядками, причому `Replace` є однією з найчастіше використовуваних функцій. Однак ця функція лише частково відображає можливості VBA з точки зору маніпулювання рядками.

Історично, VBA перейняла від своїх попередників акцент на простоті для задач автоматизації офісних завдань, тому проста реалізація функцій на кшталт `Replace`. Однак, для сучасних програмувальних задач, особливо тих, що передбачають складні маніпуляції з рядками або їх санітацію, VBA може виявити свої обмеження.

У таких випадках програмісти можуть вдатися до комбінування VBA з регулярними виразами (за допомогою об'єкта `VBScript_RegExp_55.RegExp`) для більшої гнучкості та потужності у розборі та маніпуляції з рядками. Цей підхід, однак, запроваджує додаткову складність і вимагає міцного розуміння шаблонів regex, що може бути не під силу всім користувачам.

Незважаючи на свої обмеження, функція `Replace` VBA ефективно покриває багато поширених сценаріїв пов’язаних з видаленням лапок з рядків. Вона служить швидким та легким рішенням для більшості потреб маніпулювання рядками без занурення у більш складну територію regex. Для тих, хто досягає меж можливостей `Replace` та інших базових функцій маніпулювання рядками, вивчення regex у VBA або розгляд мови, спеціалізованої на складних операціях з рядками, можуть стати наступними кроками.
