---
changelog:
- 2024-03-17, gpt-4-0125-preview, translated from English
date: 2024-03-17 21:48:27.159881-06:00
description: "\u0E01\u0E32\u0E23\u0E41\u0E17\u0E23\u0E01\u0E2A\u0E15\u0E23\u0E34\u0E07\
  \u0E43\u0E19 Visual Basic for Applications (VBA) \u0E40\u0E1B\u0E47\u0E19\u0E01\u0E23\
  \u0E30\u0E1A\u0E27\u0E19\u0E01\u0E32\u0E23\u0E02\u0E2D\u0E07\u0E01\u0E32\u0E23\u0E1D\
  \u0E31\u0E07\u0E15\u0E31\u0E27\u0E41\u0E1B\u0E23\u0E2B\u0E23\u0E37\u0E2D\u0E19\u0E34\
  \u0E1E\u0E08\u0E19\u0E4C\u0E20\u0E32\u0E22\u0E43\u0E19\u0E2A\u0E15\u0E23\u0E34\u0E07\
  \u0E17\u0E35\u0E48\u0E01\u0E33\u0E2B\u0E19\u0E14\u0E44\u0E27\u0E49\u0E25\u0E48\u0E27\
  \u0E07\u0E2B\u0E19\u0E49\u0E32\u2026"
lastmod: '2024-03-17T21:57:56.023234-06:00'
model: gpt-4-0125-preview
summary: "\u0E01\u0E32\u0E23\u0E41\u0E17\u0E23\u0E01\u0E2A\u0E15\u0E23\u0E34\u0E07\
  \u0E43\u0E19 Visual Basic for Applications (VBA) \u0E40\u0E1B\u0E47\u0E19\u0E01\u0E23\
  \u0E30\u0E1A\u0E27\u0E19\u0E01\u0E32\u0E23\u0E02\u0E2D\u0E07\u0E01\u0E32\u0E23\u0E1D\
  \u0E31\u0E07\u0E15\u0E31\u0E27\u0E41\u0E1B\u0E23\u0E2B\u0E23\u0E37\u0E2D\u0E19\u0E34\
  \u0E1E\u0E08\u0E19\u0E4C\u0E20\u0E32\u0E22\u0E43\u0E19\u0E2A\u0E15\u0E23\u0E34\u0E07\
  \u0E17\u0E35\u0E48\u0E01\u0E33\u0E2B\u0E19\u0E14\u0E44\u0E27\u0E49\u0E25\u0E48\u0E27\
  \u0E07\u0E2B\u0E19\u0E49\u0E32\u2026"
title: "\u0E01\u0E32\u0E23\u0E41\u0E17\u0E23\u0E01\u0E04\u0E48\u0E32\u0E25\u0E07\u0E43\
  \u0E19\u0E2A\u0E15\u0E23\u0E34\u0E07"
---

{{< edit_this_page >}}

## อะไรและทำไม?

การแทรกสตริงใน Visual Basic for Applications (VBA) เป็นกระบวนการของการฝังตัวแปรหรือนิพจน์ภายในสตริงที่กำหนดไว้ล่วงหน้า เพื่อให้สามารถสร้างสตริงได้อย่างยืดหยุ่น โปรแกรมเมอร์ใช้เทคนิคนี้เพื่อสร้างโค้ดที่อ่านและบำรุงรักษาได้ง่ายขึ้น โดยเฉพาะเมื่อสร้างข้อความหรือข้อมูลส่งออกตามเนื้อหาของตัวแปร

## วิธีการ:

ไม่เหมือนกับภาษาบางภาษาที่มีการแทรกสตริงที่สร้างในตัว  VBA ต้องใช้วิธีการที่ต้องทำด้วยตนเองมากขึ้น โดยทั่วไปใช้งานผ่านตัวดำเนินการ `&` หรือฟังก์ชัน `Format` สำหรับการฝังตัวแปรเข้าไปในสตริง ด้านล่างคือตัวอย่างที่แสดงวิธีการเหล่านี้:

**การใช้ตัวดำเนินการ `&`:**

```vb
Dim userName As String
Dim userScore As Integer

userName = "Alice"
userScore = 95

' การเชื่อมต่อสตริงและตัวแปร
Dim message As String
message = "Congratulations, " & userName & "! Your score is " & userScore & "."
Debug.Print message
```
**ผลลัพธ์:**
```
Congratulations, Alice! Your score is 95.
```

**การใช้ฟังก์ชัน `Format`:**

สำหรับสถานการณ์ที่ซับซ้อนมากขึ้น เช่น การรวมตัวเลขหรือวันที่ที่ได้รับการจัดรูปแบบ ฟังก์ชัน `Format` เป็นสิ่งที่มีค่ามาก

```vb
Dim currentDate As Date
currentDate = Date

Dim formattedMessage As String
formattedMessage = "Today is " & Format(currentDate, "MMMM dd, yyyy") & ". Have a great day!"
Debug.Print formattedMessage
```

**ผลลัพธ์:**
```
Today is April 15, 2023. Have a great day!
```

## การดำดิ่งลึก

การแทรกสตริงที่เรารู้จักในภาษาโปรแกรมมิ่งสมัยใหม่ เช่น Python หรือ JavaScript ไม่ได้มีอยู่โดยตรงใน VBA จากอดีต นักพัฒนา VBA ต้องพึ่งพาการเชื่อมต่อโดยใช้ `&` หรือใช้ฟังก์ชัน `Format` สำหรับการใส่ค่าเข้าไปในสตริง ซึ่งอาจทำให้กระบวนการดูยากขึ้นสำหรับสตริงที่ซับซ้อนหรือต้องการการจัดรูปแบบที่เฉพาะเจาะจง ความแตกต่างนี้เน้นย้ำถึงยุคที่ VBA ถูกสร้างขึ้นและการมุ่งเน้นไปที่ความเรียบง่ายโดยตรงมากกว่าความสะดวกสบายสมัยใหม่บางอย่าง

อย่างไรก็ตาม ควรทราบว่า แม้ VBA จะไม่มีการแทรกสตริงที่สร้างไว้ในตัว การเชี่ยวชาญในการใช้ `&` สำหรับการเชื่อมต่อที่เรียบง่ายหรือ `Format` สำหรับสถานการณ์ที่ซับซ้อนขึ้น ยังคงอนุญาตให้มีการจัดการสตริงที่มีประสิทธิภาพและยืดหยุ่น สำหรับนักพัฒนาที่มาจากภาษาที่มีคุณลักษณะการแทรกสตริงในตัว นี่อาจดูเหมือนเป็นการถอยหลังในตอนแรก แต่วิธีเหล่านี้เสนอระดับของการควบคุมที่เมื่อได้รับการเชี่ยวชาญแล้ว สามารถมีพลังได้อย่างน่าเหลือเชื่อ นอกจากนั้น การย้ายไปยังสภาพแวดล้อม .NET ที่เพิ่มเติม โปรแกรมเมอร์จะพบว่าการแทรกสตริงเป็นคุณลักษณะระดับหนึ่งใน VB.NET ให้วิธีการที่คุ้นเคยและมีประสิทธิภาพมากขึ้นสำหรับการสร้างสตริงแบบไดนามิก ในแง่การปฏิบัติ การเข้าใจความแตกต่างและข้อจำกัดใน VBA สามารถช่วยให้เขียนโค้ดที่มีประสิทธิภาพ อ่านง่าย และช่วยในการเปลี่ยนไปใช้สภาพแวดล้อม Visual Basic ที่ทันสมัยยิ่งขึ้นได้หากมีความจำเป็น
