---
changelog:
- 2024-03-17, gpt-4-0125-preview, translated from English
date: 2024-03-17 21:55:02.218901-06:00
description: "\u0E01\u0E32\u0E23\u0E40\u0E02\u0E35\u0E22\u0E19\u0E44\u0E1B\u0E22\u0E31\
  \u0E07\u0E21\u0E32\u0E15\u0E23\u0E10\u0E32\u0E19\u0E02\u0E49\u0E2D\u0E1C\u0E34\u0E14\
  \u0E1E\u0E25\u0E32\u0E14\u0E43\u0E19 Visual Basic for Applications (VBA) \u0E2B\u0E21\
  \u0E32\u0E22\u0E16\u0E36\u0E07\u0E01\u0E32\u0E23\u0E19\u0E33\u0E02\u0E49\u0E2D\u0E04\
  \u0E27\u0E32\u0E21\u0E41\u0E2A\u0E14\u0E07\u0E02\u0E49\u0E2D\u0E1C\u0E34\u0E14\u0E1E\
  \u0E25\u0E32\u0E14\u0E2B\u0E23\u0E37\u0E2D\u0E01\u0E32\u0E23\u0E27\u0E34\u0E19\u0E34\
  \u0E08\u0E09\u0E31\u0E22\u0E44\u0E1B\u0E2D\u0E22\u0E39\u0E48\u0E41\u0E22\u0E01\u0E15\
  \u0E48\u0E32\u0E07\u0E2B\u0E32\u0E01\u0E08\u0E32\u0E01\u0E1C\u0E25\u0E25\u0E31\u0E1E\
  \u0E18\u0E4C\u0E21\u0E32\u0E15\u0E23\u0E10\u0E32\u0E19,\u2026"
lastmod: '2024-03-17T21:57:56.054957-06:00'
model: gpt-4-0125-preview
summary: "\u0E01\u0E32\u0E23\u0E40\u0E02\u0E35\u0E22\u0E19\u0E44\u0E1B\u0E22\u0E31\
  \u0E07\u0E21\u0E32\u0E15\u0E23\u0E10\u0E32\u0E19\u0E02\u0E49\u0E2D\u0E1C\u0E34\u0E14\
  \u0E1E\u0E25\u0E32\u0E14\u0E43\u0E19 Visual Basic for Applications (VBA) \u0E2B\u0E21\
  \u0E32\u0E22\u0E16\u0E36\u0E07\u0E01\u0E32\u0E23\u0E19\u0E33\u0E02\u0E49\u0E2D\u0E04\
  \u0E27\u0E32\u0E21\u0E41\u0E2A\u0E14\u0E07\u0E02\u0E49\u0E2D\u0E1C\u0E34\u0E14\u0E1E\
  \u0E25\u0E32\u0E14\u0E2B\u0E23\u0E37\u0E2D\u0E01\u0E32\u0E23\u0E27\u0E34\u0E19\u0E34\
  \u0E08\u0E09\u0E31\u0E22\u0E44\u0E1B\u0E2D\u0E22\u0E39\u0E48\u0E41\u0E22\u0E01\u0E15\
  \u0E48\u0E32\u0E07\u0E2B\u0E32\u0E01\u0E08\u0E32\u0E01\u0E1C\u0E25\u0E25\u0E31\u0E1E\
  \u0E18\u0E4C\u0E21\u0E32\u0E15\u0E23\u0E10\u0E32\u0E19,\u2026"
title: "\u0E01\u0E32\u0E23\u0E40\u0E02\u0E35\u0E22\u0E19\u0E44\u0E1B\u0E22\u0E31\u0E07\
  \u0E02\u0E49\u0E2D\u0E1C\u0E34\u0E14\u0E1E\u0E25\u0E32\u0E14\u0E21\u0E32\u0E15\u0E23\
  \u0E10\u0E32\u0E19"
---

{{< edit_this_page >}}

## อะไร & ทำไม?

การเขียนไปยังมาตรฐานข้อผิดพลาดใน Visual Basic for Applications (VBA) หมายถึงการนำข้อความแสดงข้อผิดพลาดหรือการวินิจฉัยไปอยู่แยกต่างหากจากผลลัพธ์มาตรฐาน, โดยปกติจะเป็นการเขียนไปยังคอนโซลหรือไฟล์ log ผู้เขียนโปรแกรมทำเช่นนี้เพื่อแยกผลลัพธ์ปกติของโปรแกรมออกจากข้อความแสดงข้อผิดพลาด, ทำให้ง่ายขึ้นในการแก้ไขโปรแกรมหรือแจ้งผู้ใช้งานเกี่ยวกับปัญหาโดยไม่ทำให้ผลลัพธ์หลักมีความยุ่งเหยิง

## วิธีการ:

ใน VBA, เนื่องจากไม่มีฟังก์ชันภายในตัวโดยตรงในการเขียนไปยังมาตรฐานข้อผิดพลาดโดยเฉพาะเหมือนในภาษาโปรแกรมอื่น ๆ, วิธีการทั่วไปที่ใช้กันคือการใช้ `Debug.Print` สำหรับการแสดงผลข้อผิดพลาดในระหว่างการพัฒนาหรือการสร้างฟังก์ชัน log แบบกำหนดเองที่เลียนแบบพฤติกรรมนี้สำหรับแอปพลิเคชันในการผลิต ด้านล่างคือตัวอย่างของวิธีการใช้งานและการใช้งานฟังก์ชันดังกล่าว:

```vb
Sub WriteToErrorLog(msg As String)
    ' ฟังก์ชันกำหนดเองเพื่อจำลองการเขียนไปยังมาตรฐานข้อผิดพลาด
    ' ในการใช้งานจริง, นี่สามารถเขียนไปยังไฟล์ log แยกกันหรือหน้าต่างดีบักกิ้งที่ได้รับการกำหนดเอง
    Open "ErrorLog.txt" For Append As #1 ' เปลี่ยน "ErrorLog.txt" เป็น path ไฟล์ log ที่คุณต้องการ
    Print #1, "ERROR: " & msg
    Close #1
    Debug.Print "ERROR: " & msg ' ยังแสดงผลให้เห็นใน Immediate Window ใน IDE เพื่อดีบักกิ้งของนักพัฒนา
End Sub

Sub Demonstration()
    ' ตัวอย่างการใช้งานฟังก์ชัน WriteToErrorLog
    WriteToErrorLog "เกิดข้อผิดพลาดขณะประมวลผลคำขอของคุณ."
End Sub
```

ตัวอย่างการแสดงผลใน "ErrorLog.txt" อาจมีลักษณะดังนี้:
```
ERROR: เกิดข้อผิดพลาดขณะประมวลผลคำขอของคุณ.
```

และใน Immediate Window ใน VBA IDE:
```
ERROR: เกิดข้อผิดพลาดขณะประมวลผลคำขอของคุณ.
```

## ศึกษาลึก

Visual Basic for Applications โดยธรรมชาติไม่รวมถึงกลไกเฉพาะเจาะจงในการเขียนไปยังมาตรฐานข้อผิดพลาด เนื่องจากมีความผสมผสานอย่างลึกซึ้งกับแอปพลิเคชันโฮสต์เช่น Excel, Word, หรือ Access ซึ่งโดยปกติจะพึ่งพาอินเตอร์เฟสผู้ใช้งานกราฟิกมากกว่าผลลัพธ์คอนโซล นี่เป็นการแยกที่น่าสังเกตจากแอปพลิเคชันที่พัฒนาโดยใช้ภาษาเช่น C หรือ Python ที่มีคอนเซปต์ของการแสดงผลและการแสดงข้อผิดพลาดมาตรฐานเป็นหลัก

โดยประวัติศาสตร์, โฟกัสของ VBA มักจะอยู่ที่การโต้ตอบกับโมเดลเอกสารของแอปพลิเคชันโฮสต์มากกว่ากลไกการบันทึกแอปพลิเคชันแบบดั้งเดิม ดังนั้น, นักพัฒนามักจะหันไปใช้การทำโซลูชันการบันทึกที่กำหนดเองเอง, เหมือนกับตัวอย่างที่แสดง, หรือการใช้การเรียก API ของ Windows สำหรับการจัดการข้อผิดพลาดและการบันทึกขั้นสูงที่ต้องการ

ในขณะที่วิธีการที่แสดงให้เห็นนำเสนอวิธีแก้ปัญหา, นักพัฒนาที่มองหาการบันทึกและการจัดการข้อผิดพลาดที่มีความสามารถอย่างมากอาจสำรวจการรวมกับระบบหรือไลบรารีภายนอกที่สามารถบันทึกได้แบบมีประสิทธิภาพมากขึ้น ในการพัฒนาสมัยใหม่, โดยเฉพาะอย่างยิ่งกับการมุ่งเน้นที่การดีบักและการบำรุงรักษา, ความสำคัญของการบันทึกที่ชัดเจน, มีบริบท, และแยกการแสดงผลและข้อผิดพลาดไม่สามารถเน้นย้ำได้มากเกินไป, ผลักดันให้มากมายมองหาโซลูชันนอกจากความสามารถภายในของ VBA.
