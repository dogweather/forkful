---
changelog:
- 2024-03-17, gpt-4-0125-preview, translated from English
date: 2024-03-17 21:45:31.926085-06:00
description: "\u0E01\u0E32\u0E23\u0E15\u0E23\u0E27\u0E08\u0E2A\u0E2D\u0E1A\u0E27\u0E48\
  \u0E32\u0E21\u0E35\u0E44\u0E14\u0E40\u0E23\u0E01\u0E17\u0E2D\u0E23\u0E35\u0E2D\u0E22\
  \u0E39\u0E48\u0E43\u0E19 Visual Basic for Applications (VBA) \u0E40\u0E1B\u0E47\u0E19\
  \u0E01\u0E32\u0E23\u0E22\u0E37\u0E19\u0E22\u0E31\u0E19\u0E27\u0E48\u0E32\u0E21\u0E35\
  \u0E42\u0E1F\u0E25\u0E40\u0E14\u0E2D\u0E23\u0E4C\u0E2D\u0E22\u0E39\u0E48\u0E20\u0E32\
  \u0E22\u0E43\u0E19\u0E23\u0E30\u0E1A\u0E1A\u0E44\u0E1F\u0E25\u0E4C\u0E01\u0E48\u0E2D\
  \u0E19\u0E17\u0E35\u0E48\u0E08\u0E30\u0E17\u0E33\u0E01\u0E32\u0E23\u0E14\u0E33\u0E40\
  \u0E19\u0E34\u0E19\u0E01\u0E32\u0E23\u0E15\u0E48\u0E32\u0E07\u0E46 \u0E40\u0E0A\u0E48\
  \u0E19\u2026"
lastmod: '2024-03-17T21:57:56.053008-06:00'
model: gpt-4-0125-preview
summary: "\u0E01\u0E32\u0E23\u0E15\u0E23\u0E27\u0E08\u0E2A\u0E2D\u0E1A\u0E27\u0E48\
  \u0E32\u0E21\u0E35\u0E44\u0E14\u0E40\u0E23\u0E01\u0E17\u0E2D\u0E23\u0E35\u0E2D\u0E22\
  \u0E39\u0E48\u0E43\u0E19 Visual Basic for Applications (VBA) \u0E40\u0E1B\u0E47\u0E19\
  \u0E01\u0E32\u0E23\u0E22\u0E37\u0E19\u0E22\u0E31\u0E19\u0E27\u0E48\u0E32\u0E21\u0E35\
  \u0E42\u0E1F\u0E25\u0E40\u0E14\u0E2D\u0E23\u0E4C\u0E2D\u0E22\u0E39\u0E48\u0E20\u0E32\
  \u0E22\u0E43\u0E19\u0E23\u0E30\u0E1A\u0E1A\u0E44\u0E1F\u0E25\u0E4C\u0E01\u0E48\u0E2D\
  \u0E19\u0E17\u0E35\u0E48\u0E08\u0E30\u0E17\u0E33\u0E01\u0E32\u0E23\u0E14\u0E33\u0E40\
  \u0E19\u0E34\u0E19\u0E01\u0E32\u0E23\u0E15\u0E48\u0E32\u0E07\u0E46 \u0E40\u0E0A\u0E48\
  \u0E19\u2026"
title: "\u0E15\u0E23\u0E27\u0E08\u0E2A\u0E2D\u0E1A\u0E27\u0E48\u0E32\u0E21\u0E35\u0E44\
  \u0E14\u0E40\u0E23\u0E47\u0E01\u0E17\u0E2D\u0E23\u0E35\u0E2B\u0E23\u0E37\u0E2D\u0E44\
  \u0E21\u0E48"
weight: 20
---

## อะไรและทำไม?

การตรวจสอบว่ามีไดเรกทอรีอยู่ใน Visual Basic for Applications (VBA) เป็นการยืนยันว่ามีโฟลเดอร์อยู่ภายในระบบไฟล์ก่อนที่จะทำการดำเนินการต่างๆ เช่น การบันทึกไฟล์หรือการสร้างไดเรกทอรีใหม่ โปรแกรมเมอร์ทำเช่นนี้เพื่อหลีกเลี่ยงข้อผิดพลาดขณะรันไทม์และรับรองว่าโค้ดของพวกเขาปฏิสัมพันธ์กับระบบไฟล์ได้อย่างมีประสิทธิภาพและถูกต้อง

## วิธีการ:

ใน VBA เพื่อตรวจสอบว่ามีไดเรกทอรีอยู่หรือไม่ คุณมักจะใช้ฟังก์ชัน `Dir` ร่วมกับแอตทริบิวต์ `vbDirectory` วิธีนี้ช่วยให้คุณตรวจสอบการมีอยู่ของโฟลเดอร์โดยระบุเส้นทางของมัน นี่คือวิธีที่คุณสามารถทำได้:

```basic
Dim folderPath As String
folderPath = "C:\TestFolder"

If Dir(folderPath, vbDirectory) = "" Then
    MsgBox "Directory does not exist.", vbExclamation
Else
    MsgBox "Directory exists.", vbInformation
End If
```

ตัวอย่างโค้ดนี้เริ่มต้นด้วยการกำหนดเส้นทางของโฟลเดอร์ (`C:\TestFolder`) ฟังก์ชัน `Dir` จากนั้นพยายามค้นหาโฟลเดอร์นี้โดยใช้แอตทริบิวต์ `vbDirectory` หากโฟลเดอร์ไม่มีอยู่ `Dir` จะคืนค่าเป็นสตริงว่าง และเราจะแสดงกล่องข้อความที่บ่งชี้ว่าไดเรกทอรีไม่มีอยู่ ในทางกลับกัน เราจะแสดงข้อความอื่นที่ระบุว่าไดเรกทอรีมีอยู่

ตัวอย่างผลลัพธ์เมื่อไดเรกทอรีไม่มีอยู่:
```
Directory does not exist.
```

ตัวอย่างผลลัพธ์เมื่อไดเรกทอรีมีอยู่:
```
Directory exists.
```

## การศึกษาลึก

การตรวจสอบว่ามีไดเรกทอรีอยู่เป็นงานพื้นฐานในภาษาโปรแกรมมิ่งมากมาย ไม่ใช่เพียงแต่ใน VBA เท่านั้น วิธีการที่อธิบายข้างต้นโดยใช้ `Dir` เป็นวิธีที่เรียบง่ายและมีประสิทธิภาพสำหรับจุดประสงค์ส่วนใหญ่ใน VBA อย่างไรก็ตาม ควรทราบว่าวิธีนี้อาจมีข้อจำกัด เช่น ในกรณีของเส้นทางเครือข่ายและการจัดการสิทธิ์ ซึ่งอาจบางครั้งให้ผลการตอบกลับที่ไม่ถูกต้องหรือผิดพลาด

โดยประวัติศาสตร์แล้ว วิธีการเข้าถึงระบบไฟล์ในภาษาโปรแกรมต่างๆ ได้พัฒนาขึ้น โดยภาษาล่าสุดมีแนวทางเชิงวัตถุ ตัวอย่างเช่น ในภาษา .NET เช่น VB.NET คุณอาจใช้ `System.IO.Directory.Exists(path)` สำหรับวิธีการตรวจสอบการมีอยู่ของไดเรกทอรีที่ตรงไปตรงมาและอาจกล่าวได้ว่ามีประสิทธิภาพมากกว่า โดยได้รับประโยชน์จากการจัดการข้อยกเว้นและข้อมูลการคืนค่าที่มากขึ้น

แม้ VBA จะไม่มีคลาสในตัวที่แข็งแกร่งเท่าที่พบใน .NET สำหรับการดำเนินการกับระบบไฟล์ การเข้าใจประโยชน์และข้อจำกัดของฟังก์ชัน `Dir` เป็นสิ่งสำคัญสำหรับการเขียนสคริปต์ VBA ที่มีประสิทธิภาพซึ่งปฏิสัมพันธ์กับระบบไฟล์ ในกรณีที่ความสามารถของ VBA ไม่เพียงพอ การรวมกันของส่วนประกอบ .NET หรือการใช้สคริปต์ภายนอกอาจเสนอทางเลือกที่ดีกว่า
