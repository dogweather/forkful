---
changelog:
- 2024-03-17, gpt-4-0125-preview, translated from English
date: 2024-03-17 21:50:04.606343-06:00
description: "\u0E01\u0E32\u0E23\u0E2D\u0E48\u0E32\u0E19\u0E2D\u0E32\u0E23\u0E4C\u0E01\
  \u0E34\u0E27\u0E40\u0E21\u0E19\u0E15\u0E4C\u0E1A\u0E23\u0E23\u0E17\u0E31\u0E14\u0E04\
  \u0E33\u0E2A\u0E31\u0E48\u0E07\u0E43\u0E19 Visual Basic for Applications (VBA) \u0E2B\
  \u0E21\u0E32\u0E22\u0E16\u0E36\u0E07\u0E01\u0E32\u0E23\u0E40\u0E02\u0E49\u0E32\u0E16\
  \u0E36\u0E07\u0E1E\u0E32\u0E23\u0E32\u0E21\u0E34\u0E40\u0E15\u0E2D\u0E23\u0E4C\u0E17\
  \u0E35\u0E48\u0E16\u0E39\u0E01\u0E2A\u0E48\u0E07\u0E21\u0E32\u0E22\u0E31\u0E07\u0E42\
  \u0E1B\u0E23\u0E41\u0E01\u0E23\u0E21\u0E02\u0E2D\u0E07\u0E04\u0E38\u0E13\u0E40\u0E21\
  \u0E37\u0E48\u0E2D\u0E40\u0E23\u0E34\u0E48\u0E21\u0E01\u0E32\u0E23\u0E17\u0E33\u0E07\
  \u0E32\u0E19\u2026"
lastmod: '2024-03-17T21:57:56.053988-06:00'
model: gpt-4-0125-preview
summary: "\u0E01\u0E32\u0E23\u0E2D\u0E48\u0E32\u0E19\u0E2D\u0E32\u0E23\u0E4C\u0E01\
  \u0E34\u0E27\u0E40\u0E21\u0E19\u0E15\u0E4C\u0E1A\u0E23\u0E23\u0E17\u0E31\u0E14\u0E04\
  \u0E33\u0E2A\u0E31\u0E48\u0E07\u0E43\u0E19 Visual Basic for Applications (VBA) \u0E2B\
  \u0E21\u0E32\u0E22\u0E16\u0E36\u0E07\u0E01\u0E32\u0E23\u0E40\u0E02\u0E49\u0E32\u0E16\
  \u0E36\u0E07\u0E1E\u0E32\u0E23\u0E32\u0E21\u0E34\u0E40\u0E15\u0E2D\u0E23\u0E4C\u0E17\
  \u0E35\u0E48\u0E16\u0E39\u0E01\u0E2A\u0E48\u0E07\u0E21\u0E32\u0E22\u0E31\u0E07\u0E42\
  \u0E1B\u0E23\u0E41\u0E01\u0E23\u0E21\u0E02\u0E2D\u0E07\u0E04\u0E38\u0E13\u0E40\u0E21\
  \u0E37\u0E48\u0E2D\u0E40\u0E23\u0E34\u0E48\u0E21\u0E01\u0E32\u0E23\u0E17\u0E33\u0E07\
  \u0E32\u0E19 \u0E27\u0E34\u0E18\u0E35\u0E01\u0E32\u0E23\u0E19\u0E35\u0E49\u0E21\u0E31\
  \u0E01\u0E16\u0E39\u0E01\u0E43\u0E0A\u0E49\u0E40\u0E1E\u0E37\u0E48\u0E2D\u0E21\u0E35\
  \u0E2D\u0E34\u0E17\u0E18\u0E34\u0E1E\u0E25\u0E15\u0E48\u0E2D\u0E1E\u0E24\u0E15\u0E34\
  \u0E01\u0E23\u0E23\u0E21\u0E2B\u0E23\u0E37\u0E2D\u0E1C\u0E25\u0E25\u0E31\u0E1E\u0E18\
  \u0E4C\u0E02\u0E2D\u0E07\u0E42\u0E1B\u0E23\u0E41\u0E01\u0E23\u0E21\u0E42\u0E14\u0E22\
  \u0E44\u0E21\u0E48\u0E15\u0E49\u0E2D\u0E07\u0E01\u0E32\u0E23\u0E04\u0E27\u0E32\u0E21\
  \u0E21\u0E35\u0E2A\u0E48\u0E27\u0E19\u0E23\u0E48\u0E27\u0E21\u0E02\u0E2D\u0E07\u0E1C\
  \u0E39\u0E49\u0E43\u0E0A\u0E49 \u0E17\u0E33\u0E43\u0E2B\u0E49\u0E07\u0E32\u0E19\u0E01\
  \u0E32\u0E23\u0E1B\u0E23\u0E31\u0E1A\u0E43\u0E2B\u0E49\u0E40\u0E1B\u0E47\u0E19\u0E2D\
  \u0E31\u0E15\u0E42\u0E19\u0E21\u0E31\u0E15\u0E34\u0E41\u0E25\u0E30\u0E07\u0E32\u0E19\
  \u0E2A\u0E04\u0E23\u0E34\u0E1B\u0E15\u0E4C\u0E07\u0E48\u0E32\u0E22\u0E41\u0E25\u0E30\
  \u0E2B\u0E25\u0E32\u0E01\u0E2B\u0E25\u0E32\u0E22\u0E21\u0E32\u0E01\u0E02\u0E36\u0E49\
  \u0E19."
title: "\u0E01\u0E32\u0E23\u0E2D\u0E48\u0E32\u0E19\u0E2D\u0E32\u0E23\u0E4C\u0E01\u0E34\
  \u0E27\u0E40\u0E21\u0E19\u0E15\u0E4C\u0E08\u0E32\u0E01\u0E04\u0E33\u0E2A\u0E31\u0E48\
  \u0E07\u0E25\u0E33\u0E14\u0E31\u0E1A"
weight: 23
---

## อะไรและทำไม?

การอ่านอาร์กิวเมนต์บรรทัดคำสั่งใน Visual Basic for Applications (VBA) หมายถึงการเข้าถึงพารามิเตอร์ที่ถูกส่งมายังโปรแกรมของคุณเมื่อเริ่มการทำงาน วิธีการนี้มักถูกใช้เพื่อมีอิทธิพลต่อพฤติกรรมหรือผลลัพธ์ของโปรแกรมโดยไม่ต้องการความมีส่วนร่วมของผู้ใช้ ทำให้งานการปรับให้เป็นอัตโนมัติและงานสคริปต์ง่ายและหลากหลายมากขึ้น

## วิธีการ:

ไม่เหมือนกับสภาพแวดล้อมการเขียนโปรแกรมที่ตรงไปตรงมากว่า VBA ไม่มีคุณลักษณะในตัวเพื่ออ่านอาร์กิวเมนต์บรรทัดคำสั่งโดยตรงในแง่ปกติ เพราะมันถูกออกแบบมาสำหรับการฝังภายในแอพพลิเคชัน Microsoft Office อย่างไรก็ตาม ด้วยความคิดสร้างสรรค์เล็กน้อย เราสามารถใช้ Windows Script Host (WSH) หรือเรียก API ภายนอกเพื่อบรรลุฟังก์ชันค์ที่คล้ายกัน ต่อไปนี้เป็นแนวทางปฏิบัติโดยใช้ WSH:

1. **สร้างไฟล์ VBScript เพื่อส่งอาร์กิวเมนต์ไปยัง VBA:**

   ขั้นแรก เขียนไฟล์ VBScript (*yourScript.vbs*) ที่ทำการเปิดแอพพลิเคชัน VBA ของคุณ (เช่น แมโคร Excel) และส่งอาร์กิวเมนต์บรรทัดคำสั่งไป:

```vb
Set objExcel = CreateObject("Excel.Application")
objExcel.Workbooks.Open "C:\YourMacroWorkbook.xlsm"
objExcel.Run "YourMacroName", WScript.Arguments.Item(0), WScript.Arguments.Item(1)
objExcel.Quit
```

2. **เข้าถึงอาร์กิวเมนต์ใน VBA:**

   ในแอพพลิเคชัน VBA ของคุณ (*YourMacroWorkbook.xlsm*), ปรับเปลี่ยนหรือสร้างแมโคร (*YourMacroName*)เพื่อยอมรับพารามิเตอร์:

```vb
Sub YourMacroName(arg1 As String, arg2 As String)
    MsgBox "Argument 1: " & arg1 & " Argument 2: " & arg2
End Sub
```

3. **รันสคริปต์ของคุณ:**

   ทำการรัน VBScript จากบรรทัดคำสั่ง โดยส่งอาร์กิวเมนต์ตามที่ต้องการ:

```shell
cscript yourScript.vbs "Hello" "World"
```

   สิ่งนี้ควรทำให้แมโคร VBA ของคุณถูกทำการอ้างอิงด้วยอาร์กิวเมนต์ "Hello" และ "World" แสดงผลในกล่องข้อความ

## การศึกษาลึก:

ในบริบททางประวัติศาสตร์ VBA ถูกออกแบบมาเพื่อขยายความสามารถของแอพพลิเคชัน Microsoft Office ไม่ใช่เป็นสภาพแวดล้อมการโปรแกรมแบบอิสระ ด้วยเหตุนี้ การโต้ตอบโดยตรงกับบรรทัดคำสั่งจึงอยู่นอกขอบเขตหลัก ซึ่งอธิบายถึงการขาดการสนับสนุนตรงสำหรับการอ่านอาร์กิวเมนต์บรรทัดคำสั่ง

วิธีการที่ได้กล่าวมาข้างต้น ถึงแม้จะมีประสิทธิภาพ แต่เป็นเพียงวิธีแก้ปัญหามากกว่าการให้บริการแบบดั้งเดิม ใช้การสคริปต์ภายนอกเพื่อเชื่อมต่อช่องว่าง วิธีนี้สามารถนำเข้าความซับซ้อนและประเด็นความปลอดภัยอาจเกิดขึ้นเนื่องจากต้องการให้เปิดใช้งานแมโครและอาจต้องปรับลดการตั้งค่าความปลอดภัยเพื่อการปฏิบัติการ

สำหรับงานที่พึ่งพาอาร์กิวเมนต์บรรทัดคำสั่งอย่างหนักหรือต้องการการรวมเข้ากับระบบปฏิบัติการ Windows อย่างราบรื่น ภาษาโปรแกรมอื่นๆ เช่น PowerShell หรือ Python อาจนำเสนอโซลูชันที่เข้มแข็งและปลอดภัยมากขึ้น ทางเลือกเหล่านี้ให้การสนับสนุนอาร์กิวเมนต์บรรทัดคำสั่งโดยตรงและเหมาะสมกว่าสำหรับแอพพลิเคชันหรือสคริปต์แบบอิสระที่ต้องการข้อมูลจากภายนอกเพื่อดัดแปลงพฤติกรรมของพวกเขาอย่างไดนามิก
