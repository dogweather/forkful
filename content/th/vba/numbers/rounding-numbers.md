---
changelog:
- 2024-03-17, gpt-4-0125-preview, translated from English
date: 2024-03-17 21:50:54.363452-06:00
description: "\u0E01\u0E32\u0E23\u0E1B\u0E31\u0E14\u0E40\u0E28\u0E29\u0E15\u0E31\u0E27\
  \u0E40\u0E25\u0E02\u0E43\u0E19\u0E01\u0E32\u0E23\u0E40\u0E02\u0E35\u0E22\u0E19\u0E42\
  \u0E1B\u0E23\u0E41\u0E01\u0E23\u0E21\u0E04\u0E37\u0E2D\u0E40\u0E01\u0E35\u0E48\u0E22\
  \u0E27\u0E01\u0E31\u0E1A\u0E01\u0E32\u0E23\u0E1B\u0E23\u0E30\u0E21\u0E32\u0E13\u0E04\
  \u0E48\u0E32\u0E15\u0E31\u0E27\u0E40\u0E25\u0E02\u0E43\u0E2B\u0E49\u0E43\u0E01\u0E25\
  \u0E49\u0E40\u0E04\u0E35\u0E22\u0E07\u0E01\u0E31\u0E1A\u0E40\u0E25\u0E02\u0E17\u0E31\
  \u0E49\u0E07\u0E2B\u0E21\u0E14\u0E2B\u0E23\u0E37\u0E2D\u0E08\u0E19\u0E16\u0E36\u0E07\
  \u0E08\u0E33\u0E19\u0E27\u0E19\u0E17\u0E28\u0E19\u0E34\u0E22\u0E21\u0E17\u0E35\u0E48\
  \u0E01\u0E33\u0E2B\u0E19\u0E14\u2026"
lastmod: '2024-03-17T21:57:56.032327-06:00'
model: gpt-4-0125-preview
summary: "\u0E01\u0E32\u0E23\u0E1B\u0E31\u0E14\u0E40\u0E28\u0E29\u0E15\u0E31\u0E27\
  \u0E40\u0E25\u0E02\u0E43\u0E19\u0E01\u0E32\u0E23\u0E40\u0E02\u0E35\u0E22\u0E19\u0E42\
  \u0E1B\u0E23\u0E41\u0E01\u0E23\u0E21\u0E04\u0E37\u0E2D\u0E40\u0E01\u0E35\u0E48\u0E22\
  \u0E27\u0E01\u0E31\u0E1A\u0E01\u0E32\u0E23\u0E1B\u0E23\u0E30\u0E21\u0E32\u0E13\u0E04\
  \u0E48\u0E32\u0E15\u0E31\u0E27\u0E40\u0E25\u0E02\u0E43\u0E2B\u0E49\u0E43\u0E01\u0E25\
  \u0E49\u0E40\u0E04\u0E35\u0E22\u0E07\u0E01\u0E31\u0E1A\u0E40\u0E25\u0E02\u0E17\u0E31\
  \u0E49\u0E07\u0E2B\u0E21\u0E14\u0E2B\u0E23\u0E37\u0E2D\u0E08\u0E19\u0E16\u0E36\u0E07\
  \u0E08\u0E33\u0E19\u0E27\u0E19\u0E17\u0E28\u0E19\u0E34\u0E22\u0E21\u0E17\u0E35\u0E48\
  \u0E01\u0E33\u0E2B\u0E19\u0E14\u2026"
title: "\u0E01\u0E32\u0E23\u0E1B\u0E31\u0E14\u0E40\u0E28\u0E29\u0E02\u0E2D\u0E07\u0E15\
  \u0E31\u0E27\u0E40\u0E25\u0E02"
weight: 13
---

## อะไร & ทำไม?

การปัดเศษตัวเลขในการเขียนโปรแกรมคือเกี่ยวกับการประมาณค่าตัวเลขให้ใกล้เคียงกับเลขทั้งหมดหรือจนถึงจำนวนทศนิยมที่กำหนด โปรแกรมเมอร์ปัดเศษตัวเลขเพื่อให้ตัวเลขง่ายต่อการทำความเข้าใจ, ปรับปรุงการอ่านได้ง่าย, หรือตามเกณฑ์ตัวเลขเฉพาะในการคำนวณ, เฉพาะอย่างยิ่งในการคำนวณทางการเงินที่ความแม่นยำมีความสำคัญ

## วิธีการ:

ใน Visual Basic for Applications (VBA), การปัดเศษสามารถทำได้โดยใช้ฟังก์ชันหลายตัว, แต่ละตัวเหมาะกับสถานการณ์เฉพาะ นี่คือฟังก์ชันที่ใช้กันอย่างแพร่หลายพร้อมตัวอย่าง:

1. **ฟังก์ชัน Round**:
   ฟังก์ชัน `Round` จะปัดเศษตัวเลขไปยังจำนวนทศนิยมที่กำหนด
   ```basic
   Dim roundedNumber As Double
   roundedNumber = Round(3.14159, 2)  ' ผลลัพธ์: 3.14
   MsgBox roundedNumber
   ```
   
2. **ฟังก์ชัน Int และ Fix**:
   ทั้ง `Int` และ `Fix` ใช้สำหรับการปัดเศษตัวเลขลงไปยังจำนวนเต็มที่ใกล้ที่สุด, แต่พวกมันมีพฤติกรรมที่แตกต่างกันกับตัวเลขลบ
   ```basic
   Dim intRounded As Integer
   Dim fixRounded As Integer
   
   intRounded = Int(-3.14159)  ' ผลลัพธ์: -4
   fixRounded = Fix(-3.14159)  ' ผลลัพธ์: -3
   
   MsgBox "Int: " & intRounded & ", Fix: " & fixRounded
   ```

3. **ฟังก์ชัน Ceiling และ Floor**:
   VBA ไม่มีฟังก์ชัน `Ceiling` และ `Floor` ที่พบในภาษาอื่น ๆ เพื่อจำลองฟังก์ชันนี้, ใช้ `Application.WorksheetFunction.Ceiling_Math` และ `Application.WorksheetFunction.Floor_Math` สำหรับ Excel VBA
   ```basic
   Dim ceilingNumber As Double
   Dim floorNumber As Double
   
   ceilingNumber = Application.WorksheetFunction.Ceiling_Math(3.14159)  ' ผลลัพธ์: 4
   floorNumber = Application.WorksheetFunction.Floor_Math(3.14159)  ' ผลลัพธ์: 3
   
   MsgBox "Ceiling: " & ceilingNumber & ", Floor: " & floorNumber
   ```

## ลงลึก

ฟังก์ชัน `Round` ใน VBA แตกต่างจากวิธีการปัดเศษในภาษาอื่น ๆ เนื่องจากใช้ **Banker's Rounding**. Banker's Rounding จะปัดไปยังตัวเลขที่เป็นเลขคู่ที่ใกล้ที่สุดเมื่ออยู่ตรงกลางระหว่างสองตัวเลข, ลดอคติในการคำนวณในชุดข้อมูลขนาดใหญ่ และให้ผลลัพธ์ที่มีนัยสำคัญทางสถิติมากขึ้น อย่างไรก็ตาม, สิ่งนี้อาจนำไปสู่พฤติกรรมที่ไม่คาดคิดสำหรับผู้ที่ไม่คุ้นเคยกับมัน, เฉพาะเมื่อความแม่นยำทางจำนวนเต็มคาดหวังในทุกกรณี

ในทางตรงกันข้าม, ภาษาโปรแกรมและระบบหลายอย่างใช้ "arithmetic rounding" หรือ "half-up rounding", ที่ตัวเลขที่อยู่ตรงกลางระหว่างสองค่าที่สามารถปัดเศษได้จะถูกปัดขึ้นเสมอ เมื่อแปลหรือย้ายโค้ดจากภาษาอื่นไปยัง VBA, โปรแกรมเมอร์ต้องคำนึงถึงความแตกต่างเหล่านี้เพื่อหลีกเลี่ยงข้อบกพร่องหรือความไม่ถูกต้องอย่างละเอียดในการใช้งานทางการเงินและสถิติ

แม้ว่า VBA จะมีฟังก์ชันสำหรับการปัดเศษหลายอย่าง, แต่การขาดฟังก์ชัน `Ceiling` และ `Floor` (โดยไม่ต้องใช้ WorksheetFunction ของ Excel) เน้นถึงข้อจำกัดในความสามารถพื้นฐาน โปรแกรมเมอร์ที่มาจากภาษาที่มีคุณสมบัติหลากหลายอาจพบว่าความบกพร่องเหล่านี้ไม่สะดวกและอาจต้องการทำโซลูชันกำหนดเองหรือปรับการคำนวณเพื่อใช้ฟังก์ชันที่มีอยู่ แม้จะมีข้อจำกัดเหล่านี้, การเข้าใจและใช้ฟังก์ชันการปัดเศษของ VBA อย่างถูกต้องสามารถช่วยให้แน่ใจว่าการคำนวณตัวเลขมีความแม่นยำและตอบสนองต่อความต้องการของโปรแกรมการใช้งานส่วนใหญ่
