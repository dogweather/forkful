---
changelog:
- 2024-03-17, gpt-4-0125-preview, translated from English
date: 2024-03-17 21:48:52.183624-06:00
description: "\u0E01\u0E32\u0E23\u0E08\u0E31\u0E14\u0E23\u0E30\u0E40\u0E1A\u0E35\u0E22\
  \u0E1A\u0E42\u0E04\u0E49\u0E14\u0E40\u0E02\u0E49\u0E32\u0E01\u0E31\u0E1A\u0E1F\u0E31\
  \u0E07\u0E01\u0E4C\u0E0A\u0E31\u0E19\u0E04\u0E37\u0E2D\u0E40\u0E23\u0E37\u0E48\u0E2D\
  \u0E07\u0E02\u0E2D\u0E07\u0E01\u0E32\u0E23\u0E42\u0E04\u0E23\u0E07\u0E2A\u0E23\u0E49\
  \u0E32\u0E07\u0E42\u0E04\u0E49\u0E14 Google Apps Script \u0E02\u0E2D\u0E07\u0E04\
  \u0E38\u0E13\u0E42\u0E14\u0E22\u0E41\u0E1A\u0E48\u0E07\u0E2A\u0E48\u0E27\u0E19\u0E17\
  \u0E35\u0E48\u0E15\u0E23\u0E23\u0E01\u0E30\u0E2D\u0E2D\u0E01\u0E40\u0E1B\u0E47\u0E19\
  \u0E1A\u0E25\u0E47\u0E2D\u0E01\u0E17\u0E35\u0E48\u0E41\u0E22\u0E01\u0E01\u0E31\u0E19\
  \u2026"
lastmod: '2024-03-17T21:57:55.723961-06:00'
model: gpt-4-0125-preview
summary: "\u0E01\u0E32\u0E23\u0E08\u0E31\u0E14\u0E23\u0E30\u0E40\u0E1A\u0E35\u0E22\
  \u0E1A\u0E42\u0E04\u0E49\u0E14\u0E40\u0E02\u0E49\u0E32\u0E01\u0E31\u0E1A\u0E1F\u0E31\
  \u0E07\u0E01\u0E4C\u0E0A\u0E31\u0E19\u0E04\u0E37\u0E2D\u0E40\u0E23\u0E37\u0E48\u0E2D\
  \u0E07\u0E02\u0E2D\u0E07\u0E01\u0E32\u0E23\u0E42\u0E04\u0E23\u0E07\u0E2A\u0E23\u0E49\
  \u0E32\u0E07\u0E42\u0E04\u0E49\u0E14 Google Apps Script \u0E02\u0E2D\u0E07\u0E04\
  \u0E38\u0E13\u0E42\u0E14\u0E22\u0E41\u0E1A\u0E48\u0E07\u0E2A\u0E48\u0E27\u0E19\u0E17\
  \u0E35\u0E48\u0E15\u0E23\u0E23\u0E01\u0E30\u0E2D\u0E2D\u0E01\u0E40\u0E1B\u0E47\u0E19\
  \u0E1A\u0E25\u0E47\u0E2D\u0E01\u0E17\u0E35\u0E48\u0E41\u0E22\u0E01\u0E01\u0E31\u0E19\
  \ \u0E41\u0E15\u0E48\u0E25\u0E30\u0E1A\u0E25\u0E47\u0E2D\u0E01\u0E17\u0E33\u0E07\
  \u0E32\u0E19\u0E17\u0E35\u0E48\u0E40\u0E09\u0E1E\u0E32\u0E30\u0E40\u0E08\u0E32\u0E30\
  \u0E08\u0E07 \u0E42\u0E1B\u0E23\u0E41\u0E01\u0E23\u0E21\u0E40\u0E21\u0E2D\u0E23\u0E4C\
  \u0E17\u0E33\u0E2D\u0E22\u0E48\u0E32\u0E07\u0E19\u0E35\u0E49\u0E40\u0E1E\u0E37\u0E48\
  \u0E2D\u0E40\u0E1E\u0E34\u0E48\u0E21\u0E04\u0E27\u0E32\u0E21\u0E2A\u0E32\u0E21\u0E32\
  \u0E23\u0E16\u0E43\u0E19\u0E01\u0E32\u0E23\u0E2D\u0E48\u0E32\u0E19 \u0E01\u0E32\u0E23\
  \u0E1A\u0E33\u0E23\u0E38\u0E07\u0E23\u0E31\u0E01\u0E29\u0E32 \u0E41\u0E25\u0E30\u0E01\
  \u0E32\u0E23\u0E43\u0E0A\u0E49\u0E07\u0E32\u0E19\u0E42\u0E04\u0E49\u0E14\u0E44\u0E14\
  \u0E49\u0E2D\u0E35\u0E01\u0E04\u0E23\u0E31\u0E49\u0E07 \u0E23\u0E31\u0E1A\u0E23\u0E2D\
  \u0E07\u0E27\u0E48\u0E32\u0E2A\u0E04\u0E23\u0E34\u0E1B\u0E15\u0E4C\u0E17\u0E35\u0E48\
  \u0E0B\u0E31\u0E1A\u0E0B\u0E49\u0E2D\u0E19\u0E2A\u0E32\u0E21\u0E32\u0E23\u0E16\u0E40\
  \u0E02\u0E49\u0E32\u0E43\u0E08\u0E41\u0E25\u0E30\u0E41\u0E01\u0E49\u0E44\u0E02\u0E07\
  \u0E48\u0E32\u0E22\u0E02\u0E36\u0E49\u0E19."
title: "\u0E01\u0E32\u0E23\u0E08\u0E31\u0E14\u0E23\u0E30\u0E40\u0E1A\u0E35\u0E22\u0E1A\
  \u0E42\u0E04\u0E49\u0E14\u0E40\u0E02\u0E49\u0E32\u0E44\u0E1B\u0E43\u0E19\u0E1F\u0E31\
  \u0E07\u0E01\u0E4C\u0E0A\u0E31\u0E19"
weight: 18
---

## อะไรและทำไม?

การจัดระเบียบโค้ดเข้ากับฟังก์ชันคือเรื่องของการโครงสร้างโค้ด Google Apps Script ของคุณโดยแบ่งส่วนที่ตรรกะออกเป็นบล็อกที่แยกกัน แต่ละบล็อกทำงานที่เฉพาะเจาะจง โปรแกรมเมอร์ทำอย่างนี้เพื่อเพิ่มความสามารถในการอ่าน การบำรุงรักษา และการใช้งานโค้ดได้อีกครั้ง รับรองว่าสคริปต์ที่ซับซ้อนสามารถเข้าใจและแก้ไขง่ายขึ้น

## วิธีทำ:

ใน Google Apps Script ซึ่งอิงตาม JavaScript คุณกำหนดฟังก์ชันโดยใช้คำหลัก `function` ตามด้วยชื่อฟังก์ชันที่ไม่ซ้ำกัน วงเล็บ `()` ซึ่งสามารถมีพารามิเตอร์ และวงเล็บปีกกา `{}` ที่ห่อหุ้มบล็อกโค้ดของฟังก์ชัน ตัวอย่างพื้นฐาน:

```javascript
function greetUser() {
  var user = Session.getActiveUser().getEmail();
  Logger.log('สวัสดี, ' + user + '!');
}

greetUser();
```

ตัวอย่างผลลัพธ์:

```
สวัสดี, someone@example.com!
```

ตอนนี้, มาพิจารณาตัวอย่างที่มีประโยชน์มากขึ้นที่เกี่ยวข้องกับ Google Sheets ที่เราแยกฟังก์ชั่นออกเป็นสองฟังก์ชัน: หนึ่งสำหรับการตั้งค่าแผ่นงาน และอีกหนึ่งสำหรับการเติมข้อมูลลงในแผ่นงาน

```javascript
function setupSheet() {
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var sheet = ss.getSheets()[0];
  sheet.setName('ข้อมูลการขาย');
  sheet.appendRow(['สินค้า', 'ปริมาณ', 'ราคา']);
}

function populateSheet(data) {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName('ข้อมูลการขาย');
  data.forEach(function(row) {
    sheet.appendRow(row);
  });
}

// สร้างอาร์เรย์ของข้อมูล
var salesData = [
  ['Widgets', 15, 2.5],
  ['Gadgets', 8, 3.75]
];

// รันฟังก์ชัน
setupSheet();
populateSheet(salesData);
```

ในตัวอย่างนี้, `setupSheet` เตรียมแผ่นงาน และ `populateSheet` ใช้อาร์เรย์ของข้อมูลการขายเพื่อเติมข้อมูลลงในแผ่นงาน การแยกส่วนเหล่านี้ทำให้โค้ดสะอาดและยืดหยุ่นมากขึ้นต่อการเปลี่ยนแปลง

## การศึกษาลึก

แนวคิดในการแบ่งโค้ดเป็นฟังก์ชันไม่ใช่เรื่องใหม่หรือเฉพาะกับ Google Apps Script; มันเป็นประเพณีการเขียนโปรแกรมที่สำคัญที่สนับสนุนในภาษาการเขียนโปรแกรมเกือบทั้งหมด ด้วยประวัติศาสตร์, ฟังก์ชันพัฒนามาจากแนวคิดทางคณิตศาสตร์เกี่ยวกับการส่งแมปอินพุตไปยังเอาต์พุต ซึ่งกลายเป็นหัวระแหงในการเขียนโปรแกรมแบบโครงสร้างพื้นฐาน วิธีนี้ส่งเสริมการทำงานแบบโมดูลาร์และการใช้โค้ดซ้ำ นำเสนอวิธีการที่ชัดเจนสำหรับการทดสอบส่วนต่างๆ ของสคริปต์

Google Apps Script ที่อิงตาม JavaScript ได้รับประโยชน์อย่างมากจากฟังก์ชันชั้นหนึ่งของ JavaScript ซึ่งอนุญาตให้ฟังก์ชันถูกส่งผ่านเป็นอาร์กิวเมนท์ ส่งคืนจากฟังก์ชันอื่น และกำหนดให้กับตัวแปร คุณลักษณะนี้เปิดประตูสู่รูปแบบขั้นสูงเช่นการเรียกฟังก์ชันย้อนกลับและการเขียนโปรแกรมฟังก์ชันแบบฟังก์ชัน แม้ว่ารูปแบบเหล่านี้อาจนำเข้าความซับซ้อนที่อาจไม่จำเป็นสำหรับงานอัตโนมัติง่ายๆ ใน Google Apps Script

สำหรับโปรเจ็กต์ขนาดใหญ่หรือแอปพลิเคชันที่ซับซ้อนมากขึ้น นักพัฒนาอาจสำรวจการใช้งานคุณสมบัติใหม่ๆ ของ JavaScript เช่น ฟังก์ชันแบบลูกศร, async/await สำหรับการดำเนินการแบบเรียงซ้อน และแม้กระทั่ง TypeScript สำหรับการพิมพ์แบบคงที่ TypeScript เป็นอย่างเฉพาะสามารถคอมไพล์เพื่อใช้งานเป็น Google Apps Script ให้ทางเลือกสำหรับนักพัฒนาที่มองหาการตรวจสอบประเภทที่แข็งแกร่งและคุณสมบัติความเป็นอ็อบเจกต์อ็อเรียนเต็ดขั้นสูง

อย่างไรก็ตาม, สำหรับความต้องการสคริปต์ภายในชุด Google Apps ส่วนใหญ่ การยึดติดกับฟังก์ชันที่เรียบง่ายและจัดระเบียบดีตามที่แสดงให้เห็นนั้นให้ฐานที่แข็งแกร่ง มันเป็นการแบ่งแยกสมดุลระหว่างการใช้คุณสมบัติขั้นสูงเพื่อประสิทธิภาพและการรักษาความเรียบง่ายเพื่อความง่ายในการบำรุงรักษาและการอ่าน
