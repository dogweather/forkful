---
changelog:
- 2024-03-17, gpt-4-0125-preview, translated from English
date: 2024-03-17 21:53:10.976199-06:00
description: "\u0E01\u0E32\u0E23\u0E17\u0E33\u0E07\u0E32\u0E19\u0E01\u0E31\u0E1A\u0E44\
  \u0E1F\u0E25\u0E4C CSV (Comma-Separated Values) \u0E43\u0E19 Google Apps Script\
  \ \u0E1B\u0E23\u0E30\u0E01\u0E2D\u0E1A\u0E14\u0E49\u0E27\u0E22\u0E01\u0E32\u0E23\
  \u0E2D\u0E48\u0E32\u0E19 \u0E01\u0E32\u0E23\u0E1B\u0E23\u0E31\u0E1A\u0E40\u0E1B\u0E25\
  \u0E35\u0E48\u0E22\u0E19\u2026"
lastmod: '2024-03-17T21:57:55.742285-06:00'
model: gpt-4-0125-preview
summary: "\u0E01\u0E32\u0E23\u0E17\u0E33\u0E07\u0E32\u0E19\u0E01\u0E31\u0E1A\u0E44\
  \u0E1F\u0E25\u0E4C CSV (Comma-Separated Values) \u0E43\u0E19 Google Apps Script\
  \ \u0E1B\u0E23\u0E30\u0E01\u0E2D\u0E1A\u0E14\u0E49\u0E27\u0E22\u0E01\u0E32\u0E23\
  \u0E2D\u0E48\u0E32\u0E19 \u0E01\u0E32\u0E23\u0E1B\u0E23\u0E31\u0E1A\u0E40\u0E1B\u0E25\
  \u0E35\u0E48\u0E22\u0E19 \u0E41\u0E25\u0E30\u0E01\u0E32\u0E23\u0E40\u0E02\u0E35\u0E22\
  \u0E19\u0E44\u0E1F\u0E25\u0E4C\u0E02\u0E49\u0E2D\u0E04\u0E27\u0E32\u0E21\u0E18\u0E23\
  \u0E23\u0E21\u0E14\u0E32\u0E17\u0E35\u0E48\u0E41\u0E15\u0E48\u0E25\u0E30\u0E1A\u0E23\
  \u0E23\u0E17\u0E31\u0E14\u0E41\u0E17\u0E19\u0E1A\u0E31\u0E19\u0E17\u0E36\u0E01\u0E02\
  \u0E49\u0E2D\u0E21\u0E39\u0E25\u0E42\u0E14\u0E22\u0E17\u0E35\u0E48\u0E04\u0E48\u0E32\
  \u0E16\u0E39\u0E01\u0E41\u0E22\u0E01\u0E14\u0E49\u0E27\u0E22\u0E08\u0E38\u0E25\u0E20\
  \u0E32\u0E04 \u0E42\u0E1B\u0E23\u0E41\u0E01\u0E23\u0E21\u0E40\u0E21\u0E2D\u0E23\u0E4C\
  \u0E17\u0E33\u0E40\u0E0A\u0E48\u0E19\u0E19\u0E35\u0E49\u0E40\u0E1E\u0E37\u0E48\u0E2D\
  \u0E01\u0E32\u0E23\u0E41\u0E25\u0E01\u0E40\u0E1B\u0E25\u0E35\u0E48\u0E22\u0E19\u0E02\
  \u0E49\u0E2D\u0E21\u0E39\u0E25\u0E23\u0E30\u0E2B\u0E27\u0E48\u0E32\u0E07\u0E41\u0E2D\
  \u0E1B\u0E1E\u0E25\u0E34\u0E40\u0E04\u0E0A\u0E31\u0E19 \u0E10\u0E32\u0E19\u0E02\u0E49\
  \u0E2D\u0E21\u0E39\u0E25 \u0E2B\u0E23\u0E37\u0E2D\u0E20\u0E32\u0E29\u0E32\u0E42\u0E1B\
  \u0E23\u0E41\u0E01\u0E23\u0E21\u0E15\u0E48\u0E32\u0E07\u0E46 \u0E44\u0E14\u0E49\u0E2D\
  \u0E22\u0E48\u0E32\u0E07\u0E07\u0E48\u0E32\u0E22\u0E14\u0E32\u0E22\u0E40\u0E19\u0E37\
  \u0E48\u0E2D\u0E07\u0E08\u0E32\u0E01 CSV \u0E44\u0E14\u0E49\u0E23\u0E31\u0E1A\u0E01\
  \u0E32\u0E23\u0E22\u0E2D\u0E21\u0E23\u0E31\u0E1A\u0E2D\u0E22\u0E48\u0E32\u0E07\u0E41\
  \u0E1E\u0E23\u0E48\u0E2B\u0E25\u0E32\u0E22\u0E43\u0E19\u0E10\u0E32\u0E19\u0E30\u0E23\
  \u0E39\u0E1B\u0E41\u0E1A\u0E1A\u0E01\u0E32\u0E23\u0E41\u0E25\u0E01\u0E40\u0E1B\u0E25\
  \u0E35\u0E48\u0E22\u0E19\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25\u0E17\u0E35\u0E48\u0E07\
  \u0E48\u0E32\u0E22\u0E41\u0E25\u0E30\u0E43\u0E0A\u0E49\u0E02\u0E49\u0E2D\u0E04\u0E27\
  \u0E32\u0E21\u0E40\u0E1B\u0E47\u0E19\u0E10\u0E32\u0E19."
title: "\u0E01\u0E32\u0E23\u0E17\u0E33\u0E07\u0E32\u0E19\u0E01\u0E31\u0E1A CSV"
weight: 37
---

## อะไรและทำไม?

การทำงานกับไฟล์ CSV (Comma-Separated Values) ใน Google Apps Script ประกอบด้วยการอ่าน การปรับเปลี่ยน และการเขียนไฟล์ข้อความธรรมดาที่แต่ละบรรทัดแทนบันทึกข้อมูลโดยที่ค่าถูกแยกด้วยจุลภาค โปรแกรมเมอร์ทำเช่นนี้เพื่อการแลกเปลี่ยนข้อมูลระหว่างแอปพลิเคชัน ฐานข้อมูล หรือภาษาโปรแกรมต่างๆ ได้อย่างง่ายดายเนื่องจาก CSV ได้รับการยอมรับอย่างแพร่หลายในฐานะรูปแบบการแลกเปลี่ยนข้อมูลที่ง่ายและใช้ข้อความเป็นฐาน

## วิธีทำ:

### การอ่านข้อมูล CSV

เพื่ออ่านข้อมูล CSV จากไฟล์ที่เก็บไว้ใน Google Drive คุณต้องได้รับเนื้อหาของไฟล์เป็นสตริงก่อน แล้วจึงแยกมันออก Google Apps Script ทำให้การเรียกเอาเนื้อหาของไฟล์เป็นเรื่องง่ายด้วยบริการ DriveApp

```javascript
function readCSV() {
  var fileId = 'YOUR_FILE_ID_HERE'; // แทนที่ด้วยรหัสไฟล์จริง
  var file = DriveApp.getFileById(fileId);
  var content = file.getBlob().getDataAsString();
  var rows = content.split("\n");
  
  for (var i = 0; i < rows.length; i++) {
    var cells = rows[i].split(",");
    Logger.log(cells); // บันทึกเซลล์ของแต่ละแถว
  }
}
```

### การเขียนข้อมูล CSV

การสร้างและเขียนไปยัง CSV ประกอบด้วยการสร้างสตริงที่มีค่าที่ถูกแยกด้วยจุลภาคและขึ้นบรรทัดใหม่ จากนั้นจึงบันทึกหรือส่งออกมัน ตัวอย่างนี้แสดงการสร้างไฟล์ CSV ใหม่ใน Google Drive

```javascript
function writeCSV() {
  var folderId = 'YOUR_FOLDER_ID_HERE'; // แทนที่ด้วยรหัสของโฟลเดอร์ Drive ที่จะสร้างไฟล์ใหม่
  var csvContent = "Name,Age,Occupation\nJohn Doe,29,Engineer\nJane Smith,34,Designer";
  var fileName = "example.csv";
  
  var folder = DriveApp.getFolderById(folderId);
  folder.createFile(fileName, csvContent, MimeType.PLAIN_TEXT);
}
```

### เอาต์พุตตัวอย่าง

เมื่อบันทึกเซลล์ของแถวจากการอ่าน CSV:

```plaintext
[John, 29, Engineer]
[Jane, 34, Designer]
```

เมื่อเขียน ไฟล์ชื่อ "example.csv" จะถูกสร้างขึ้นด้วยเนื้อหา:

```plaintext
Name,Age,Occupation
John Doe,29,Engineer
Jane Smith,34,Designer
```

## การศึกษาลึกซึ้ง

ในอดีต ไฟล์ CSV ได้รับความนิยมสำหรับความง่ายและสามารถอ่านได้โดยมนุษย์ ทำให้เขาเข้าถึงได้โดยผู้ที่ไม่ใช่นักโปรแกรมและมีประโยชน์สำหรับการตรวจสอบข้อมูลอย่างรวดเร็ว อย่างไรก็ตาม Google Apps Script ทำงานภายในโลกของระบบนิเวศของ Google ที่ Google Sheets ทำหน้าที่เป็นทางเลือกที่ทรงพลังและเป็นมิตรต่อผู้ใช้สำหรับการจัดการ CSV Sheets ไม่เพียงแต่ให้ GUI สำหรับการแก้ไขข้อมูลเท่านั้น แต่ยังรองรับสูตรที่ซับซ้อน การตกแต่ง และคุณสมบัติอื่นๆ อีกมากมายที่ CSV ดิบขาดหายไป

แม้ว่า Google Sheets จะมีข้อดี การจัดการ CSV โดยตรงใน Google Apps Script ยังคงสำคัญสำหรับงานอัตโนมัติ โดยเฉพาะเมื่อต้องรับมือกับระบบภายนอกที่สร้างหรือต้องการข้อมูลในรูปแบบ CSV ตัวอย่างเช่น การรวมกับระบบเก่า การส่งออกข้อมูลเพื่อใช้ในแอปพลิเคชันอื่น หรือการประมวลผลก่อนการป้อนข้อมูลเข้า Google Sheets

ยิ่งไปกว่านั้น ความสามารถของ Google Apps Script ในการทำงานกับไฟล์ CSV สามารถขยายได้ด้วยบริการ Utilities สำหรับความต้องการเข้ารหัสขั้นสูง หรือเชื่อมต่อกับ API ภายนอกสำหรับงานการแปลง การแยก หรือการตรวจสอบ อย่างไรก็ตาม สำหรับการทำงานกับชุดข้อมูลขนาดใหญ่หรือต้องการการจัดการที่ซับซ้อน พิจารณาใช้งาน Google Sheets API หรือสำรวจ BigQuery เพื่อความสามารถในการประมวลผลข้อมูลที่แข็งแกร่งยิ่งขึ้น

ในขณะที่ความง่ายยังคงเป็นเหตุผลหลักสำหรับความนิยมของ CSV ทางเลือกเหล่านี้มอบชุดคุณลักษณะที่หลากหลายมากขึ้นสำหรับการจัดการข้อมูลในระบบนิเวศของ Google Cloud
