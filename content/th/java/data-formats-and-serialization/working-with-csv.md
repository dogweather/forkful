---
changelog:
- 2024-03-17, gpt-4-0125-preview, translated from English
date: 2024-03-17 21:52:45.522645-06:00
description: "\u0E01\u0E32\u0E23\u0E17\u0E33\u0E07\u0E32\u0E19\u0E01\u0E31\u0E1A\u0E44\
  \u0E1F\u0E25\u0E4C CSV \u0E2B\u0E21\u0E32\u0E22\u0E16\u0E36\u0E07\u0E01\u0E32\u0E23\
  \u0E2D\u0E48\u0E32\u0E19\u0E41\u0E25\u0E30\u0E40\u0E02\u0E35\u0E22\u0E19\u0E02\u0E49\
  \u0E2D\u0E21\u0E39\u0E25\u0E44\u0E1B\u0E22\u0E31\u0E07\u0E44\u0E1F\u0E25\u0E4C\u0E04\
  \u0E48\u0E32\u0E17\u0E35\u0E48\u0E04\u0E31\u0E48\u0E19\u0E14\u0E49\u0E27\u0E22\u0E08\
  \u0E38\u0E25\u0E20\u0E32\u0E04 (CSV - Comma-Separated Values)\u2026"
lastmod: '2024-03-17T21:57:56.108546-06:00'
model: gpt-4-0125-preview
summary: "\u0E01\u0E32\u0E23\u0E17\u0E33\u0E07\u0E32\u0E19\u0E01\u0E31\u0E1A\u0E44\
  \u0E1F\u0E25\u0E4C CSV \u0E2B\u0E21\u0E32\u0E22\u0E16\u0E36\u0E07\u0E01\u0E32\u0E23\
  \u0E2D\u0E48\u0E32\u0E19\u0E41\u0E25\u0E30\u0E40\u0E02\u0E35\u0E22\u0E19\u0E02\u0E49\
  \u0E2D\u0E21\u0E39\u0E25\u0E44\u0E1B\u0E22\u0E31\u0E07\u0E44\u0E1F\u0E25\u0E4C\u0E04\
  \u0E48\u0E32\u0E17\u0E35\u0E48\u0E04\u0E31\u0E48\u0E19\u0E14\u0E49\u0E27\u0E22\u0E08\
  \u0E38\u0E25\u0E20\u0E32\u0E04 (CSV - Comma-Separated Values) \u0E0B\u0E36\u0E48\
  \u0E07\u0E40\u0E1B\u0E47\u0E19\u0E23\u0E39\u0E1B\u0E41\u0E1A\u0E1A\u0E22\u0E2D\u0E14\
  \u0E19\u0E34\u0E22\u0E21\u0E2A\u0E33\u0E2B\u0E23\u0E31\u0E1A\u0E01\u0E32\u0E23\u0E41\
  \u0E25\u0E01\u0E40\u0E1B\u0E25\u0E35\u0E48\u0E22\u0E19\u0E02\u0E49\u0E2D\u0E21\u0E39\
  \u0E25 \u0E40\u0E1E\u0E23\u0E32\u0E30\u0E21\u0E35\u0E04\u0E27\u0E32\u0E21\u0E07\u0E48\
  \u0E32\u0E22\u0E41\u0E25\u0E30\u0E44\u0E14\u0E49\u0E23\u0E31\u0E1A\u0E01\u0E32\u0E23\
  \u0E2A\u0E19\u0E31\u0E1A\u0E2A\u0E19\u0E38\u0E19\u0E2D\u0E22\u0E48\u0E32\u0E07\u0E01\
  \u0E27\u0E49\u0E32\u0E07\u0E02\u0E27\u0E32\u0E07 \u0E42\u0E1B\u0E23\u0E41\u0E01\u0E23\
  \u0E21\u0E40\u0E21\u0E2D\u0E23\u0E4C\u0E21\u0E31\u0E01\u0E08\u0E30\u0E08\u0E31\u0E14\
  \u0E01\u0E32\u0E23\u0E01\u0E31\u0E1A\u0E44\u0E1F\u0E25\u0E4C CSV \u0E2A\u0E33\u0E2B\
  \u0E23\u0E31\u0E1A\u0E07\u0E32\u0E19\u0E15\u0E48\u0E32\u0E07\u0E46 \u0E40\u0E0A\u0E48\
  \u0E19 \u0E01\u0E32\u0E23\u0E19\u0E33\u0E40\u0E02\u0E49\u0E32/\u0E2A\u0E48\u0E07\
  \u0E2D\u0E2D\u0E01\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25, \u0E01\u0E32\u0E23\u0E27\
  \u0E34\u0E40\u0E04\u0E23\u0E32\u0E30\u0E2B\u0E4C\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25\
  \ \u0E41\u0E25\u0E30\u0E01\u0E32\u0E23\u0E41\u0E1A\u0E48\u0E07\u0E1B\u0E31\u0E19\
  \u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25\u0E23\u0E30\u0E2B\u0E27\u0E48\u0E32\u0E07\u0E23\
  \u0E30\u0E1A\u0E1A\u0E15\u0E48\u0E32\u0E07\u0E46."
title: "\u0E01\u0E32\u0E23\u0E17\u0E33\u0E07\u0E32\u0E19\u0E01\u0E31\u0E1A CSV"
weight: 37
---

## อะไร & ทำไม?

การทำงานกับไฟล์ CSV หมายถึงการอ่านและเขียนข้อมูลไปยังไฟล์ค่าที่คั่นด้วยจุลภาค (CSV - Comma-Separated Values) ซึ่งเป็นรูปแบบยอดนิยมสำหรับการแลกเปลี่ยนข้อมูล เพราะมีความง่ายและได้รับการสนับสนุนอย่างกว้างขวาง โปรแกรมเมอร์มักจะจัดการกับไฟล์ CSV สำหรับงานต่างๆ เช่น การนำเข้า/ส่งออกข้อมูล, การวิเคราะห์ข้อมูล และการแบ่งปันข้อมูลระหว่างระบบต่างๆ

## วิธีการ:

### การอ่านไฟล์ CSV โดยใช้ไลบรารีมาตรฐานของ Java

Java ไม่มีการสนับสนุนเรื่อง CSV ในไลบรารีมาตรฐานโดยตรง แต่คุณสามารถอ่านไฟล์ CSV ได้ง่ายๆ โดยใช้คลาสจาก `java.io`

```java
import java.io.BufferedReader;
import java.io.FileReader;
import java.io.IOException;

public class ReadCSVExample {
    public static void main(String[] args) {
        String line;
        String csvFile = "data.csv"; // ระบุที่ตั้งของไฟล์ CSV
        try (BufferedReader br = new BufferedReader(new FileReader(csvFile))) {
            while ((line = br.readLine()) != null) {
                String[] values = line.split(","); // สมมติว่าจุลภาคคือตัวคั่น
                // ดำเนินการกับข้อมูล
                for (String value : values) {
                    System.out.print(value + " ");
                }
                System.out.println();
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}
```

### การเขียนข้อมูลลงไฟล์ CSV โดยใช้ไลบรารีมาตรฐานของ Java

เพื่อเขียนข้อมูลลงไฟล์ CSV คุณสามารถใช้คลาสจาก `java.io` เช่น `FileWriter` และ `BufferedWriter`

```java
import java.io.BufferedWriter;
import java.io.FileWriter;
import java.io.IOException;

public class WriteCSVExample {
    public static void main(String[] args) {
        String[] data = {"John", "Doe", "30", "New York"};
        String csvFile = "output.csv"; // ระบุที่ตั้งไฟล์ CSV สำหรับเอาต์พุต

        try (BufferedWriter bw = new BufferedWriter(new FileWriter(csvFile))) {
            StringBuilder sb = new StringBuilder();
            for (String value : data) {
                sb.append(value).append(","); // สมมติว่าจุลภาคคือตัวคั่น
            }
            sb.deleteCharAt(sb.length() - 1); // ลบจุลภาคตัวสุดท้าย
            bw.write(sb.toString());
            bw.newLine();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}
```

### การใช้ไลบรารีจากบุคคลที่สาม: Apache Commons CSV

Apache Commons CSV เป็นไลบรารียอดนิยมสำหรับการจัดการไฟล์ CSV ใน Java มันช่วยให้การอ่านและเขียนไฟล์ CSV ง่ายขึ้นอย่างมาก

เพิ่มการขึ้นต่อของโปรเจกต์:

สำหรับ Maven:

```xml
<dependency>
    <groupId>org.apache.commons</groupId>
    <artifactId>commons-csv</artifactId>
    <version>1.9.0</version> <!-- ตรวจสอบเวอร์ชันล่าสุด -->
</dependency>
```

#### การอ่านไฟล์ CSV:

```java
import org.apache.commons.csv.CSVFormat;
import org.apache.commons.csv.CSVParser;
import org.apache.commons.csv.CSVRecord;

import java.io.Reader;
import java.io.FileReader;
import java.io.IOException;

public class ApacheReadCSVExample {
    public static void main(String[] args) {
        String csvFile = "data.csv";
        try (Reader reader = new FileReader(csvFile);
             CSVParser csvParser = new CSVParser(reader, CSVFormat.DEFAULT)) {
            for (CSVRecord csvRecord : csvParser) {
                // เข้าถึงค่าโดยใช้ดัชนีของคอลัมน์
                String columnOne = csvRecord.get(0);
                String columnTwo = csvRecord.get(1);
                System.out.println(columnOne + " " + columnTwo);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}
```

#### การเขียนข้อมูลลงไฟล์ CSV:

```java
import org.apache.commons.csv.CSVFormat;
import org.apache.commons.csv.CSVPrinter;

import java.io.BufferedWriter;
import java.io.FileWriter;
import java.io.IOException;

public class ApacheWriteCSVExample {
    public static void main(String[] args) {
        String[] headers = {"First Name", "Last Name", "Age", "City"};
        String[] data = {"John", "Doe", "30", "New York"};

        try (BufferedWriter writer = new BufferedWriter(new FileWriter("output.csv"));
             CSVPrinter csvPrinter = new CSVPrinter(writer, CSVFormat.DEFAULT.withHeader(headers))) {
            csvPrinter.printRecord((Object[]) data); // การแคสต์เป็น Object[] จำเป็นที่นี่
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}
```

Apache Commons CSV จัดการความซับซ้อนเช่นคำพูดและจุลภาคภายในฟิลด์โดยอัตโนมัติ ทำให้เป็นตัวเลือกที่แข็งแกร่งสำหรับการจัดการ CSV ใน Java
