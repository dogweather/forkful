---
changelog:
- 2024-01-28, gpt-4-0125-preview, translated from English
date: 2024-01-28 23:58:13.306944-07:00
description: "\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u043D\
  \u0438\u0435 \u0444\u0430\u0439\u043B\u043E\u0432 \u043D\u0430 \u043C\u0435\u0441\
  \u0442\u0435 \u0441 \u043F\u043E\u043C\u043E\u0449\u044C\u044E \u043E\u0434\u043D\
  \u043E\u0441\u0442\u0440\u043E\u0447\u043D\u044B\u0445 \u043A\u043E\u043C\u0430\u043D\
  \u0434 \u0432 PowerShell \u2014 \u044D\u0442\u043E \u043F\u0440\u043E\u0446\u0435\
  \u0441\u0441 \u043F\u0440\u044F\u043C\u043E\u0433\u043E \u0438\u0437\u043C\u0435\
  \u043D\u0435\u043D\u0438\u044F \u0444\u0430\u0439\u043B\u043E\u0432 \u0438\u0437\
  \ \u043A\u043E\u043C\u0430\u043D\u0434\u043D\u043E\u0439 \u0441\u0442\u0440\u043E\
  \u043A\u0438, \u0431\u0435\u0437 \u043D\u0435\u043E\u0431\u0445\u043E\u0434\u0438\
  \u043C\u043E\u0441\u0442\u0438\u2026"
lastmod: '2024-03-13T22:44:45.443753-06:00'
model: gpt-4-0125-preview
summary: "\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u043D\
  \u0438\u0435 \u0444\u0430\u0439\u043B\u043E\u0432 \u043D\u0430 \u043C\u0435\u0441\
  \u0442\u0435 \u0441 \u043F\u043E\u043C\u043E\u0449\u044C\u044E \u043E\u0434\u043D\
  \u043E\u0441\u0442\u0440\u043E\u0447\u043D\u044B\u0445 \u043A\u043E\u043C\u0430\u043D\
  \u0434 \u0432 PowerShell \u2014 \u044D\u0442\u043E \u043F\u0440\u043E\u0446\u0435\
  \u0441\u0441 \u043F\u0440\u044F\u043C\u043E\u0433\u043E \u0438\u0437\u043C\u0435\
  \u043D\u0435\u043D\u0438\u044F \u0444\u0430\u0439\u043B\u043E\u0432 \u0438\u0437\
  \ \u043A\u043E\u043C\u0430\u043D\u0434\u043D\u043E\u0439 \u0441\u0442\u0440\u043E\
  \u043A\u0438, \u0431\u0435\u0437 \u043D\u0435\u043E\u0431\u0445\u043E\u0434\u0438\
  \u043C\u043E\u0441\u0442\u0438\u2026"
title: "\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u043D\u0438\
  \u0435 \u0444\u0430\u0439\u043B\u043E\u0432 \u043D\u0430 \u043C\u0435\u0441\u0442\
  \u0435 \u0441 \u043F\u043E\u043C\u043E\u0449\u044C\u044E \u043E\u0434\u043D\u043E\
  \u0441\u0442\u0440\u043E\u0447\u043D\u0438\u043A\u043E\u0432 CLI"
---

{{< edit_this_page >}}

## Что и Зачем?

Редактирование файлов на месте с помощью однострочных команд в PowerShell — это процесс прямого изменения файлов из командной строки, без необходимости открывать их в редакторе. Такой подход экономит время и может быть особенно удобен для пакетной обработки или автоматизации повторяющихся задач редактирования в нескольких файлах.

## Как это сделать:

### Замена текста в одном файле

Давайте начнем с простой задачи: вы хотите заменить все случаи "oldtext" на "newtext" в файле с именем example.txt. Вот как это можно сделать:

```PowerShell
(Get-Content example.txt) -replace 'oldtext', 'newtext' | Set-Content example.txt
```

Эта однострочная команда читает содержимое, выполняет замену и записывает содержимое обратно в исходный файл.

### Редактирование нескольких файлов

Что если вам нужно применить одно и то же изменение к нескольким файлам? Вот подход с использованием цикла:

```PowerShell
Get-ChildItem *.txt | ForEach-Object {
  (Get-Content $_) -replace 'oldtext', 'newtext' | Set-Content $_
}
```

Этот фрагмент находит все файлы `.txt` в текущем каталоге, заменяя "oldtext" на "newtext" в каждом из них.

### Добавление содержимого в начало или конец файлов

Добавление или вставка содержимого также может быть упрощена:

```PowerShell
# Вставка в начало
"New first line`n" + (Get-Content example.txt) | Set-Content example.txt

# Вставка в конец
(Get-Content example.txt) + "`nNew last line" | Set-Content example.txt
```

Здесь мы просто конкатенируем новое содержимое до или после существующего и сохраняем его обратно.

## Подробнее

Исторически редактирование на месте чаще ассоциировалось с инструментами Unix, такими как `sed` и `awk`. PowerShell, будучи более новым участником, изначально не включает в себя возможность редактирования на месте "из коробки". Это отчасти связано с его философией дизайна, подчеркивающей важность объектов над потоками текста, в отличие от инструментов Unix, которые обрабатывают большинство входных данных как текст.

Альтернативы PowerShell для этой задачи включают использование традиционных инструментов Unix, доступных в Windows через Cygwin или Подсистему Windows для Linux (WSL). Эти инструменты часто предлагают более краткий синтаксис для редактирования на месте благодаря их ориентации на текст.

С точки зрения реализации, важно отметить, что подход PowerShell включает чтение файла целиком в память, внесение изменений и затем запись его обратно. Хотя это хорошо работает для файлов среднего размера, это может стать неэффективным для очень больших файлов. В таких случаях можно рассмотреть использование методов `.NET` непосредственно или прибегнуть к альтернативным инструментам, предназначенным для потоковой обработки больших объемов данных.

Несмотря на эти соображения, гибкость и обширный набор функций PowerShell делают его неоценимым инструментом для манипулирования файлами непосредственно из командной строки, особенно для тех, кто уже погружен в экосистему Windows или управляет кросс-платформенными средами.
