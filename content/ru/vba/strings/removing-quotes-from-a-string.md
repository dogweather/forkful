---
changelog:
- 2024-02-01, gpt-4-0125-preview, translated from English
date: 2024-02-01 22:00:39.827860-07:00
description: "\u0423\u0434\u0430\u043B\u0435\u043D\u0438\u0435 \u043A\u0430\u0432\u044B\
  \u0447\u0435\u043A \u0438\u0437 \u0441\u0442\u0440\u043E\u043A\u0438 \u0432 VBA\
  \ \u0432\u043A\u043B\u044E\u0447\u0430\u0435\u0442 \u0432 \u0441\u0435\u0431\u044F\
  \ \u0443\u0434\u0430\u043B\u0435\u043D\u0438\u0435 \u044D\u043A\u0437\u0435\u043C\
  \u043F\u043B\u044F\u0440\u043E\u0432 \u043E\u0434\u0438\u043D\u043E\u0447\u043D\u044B\
  \u0445 (`'`) \u0438\u043B\u0438 \u0434\u0432\u043E\u0439\u043D\u044B\u0445 (`\"\
  `) \u043A\u0430\u0432\u044B\u0447\u0435\u043A, \u043A\u043E\u0442\u043E\u0440\u044B\
  \u0435 \u043C\u043E\u0433\u0443\u0442 \u0437\u0430\u043A\u043B\u044E\u0447\u0430\
  \u0442\u044C \u0432 \u0441\u0435\u0431\u0435 \u0438\u043B\u0438 \u0431\u044B\u0442\
  \u044C\u2026"
lastmod: '2024-03-11T00:14:18.326682-06:00'
model: gpt-4-0125-preview
summary: "\u0423\u0434\u0430\u043B\u0435\u043D\u0438\u0435 \u043A\u0430\u0432\u044B\
  \u0447\u0435\u043A \u0438\u0437 \u0441\u0442\u0440\u043E\u043A\u0438 \u0432 VBA\
  \ \u0432\u043A\u043B\u044E\u0447\u0430\u0435\u0442 \u0432 \u0441\u0435\u0431\u044F\
  \ \u0443\u0434\u0430\u043B\u0435\u043D\u0438\u0435 \u044D\u043A\u0437\u0435\u043C\
  \u043F\u043B\u044F\u0440\u043E\u0432 \u043E\u0434\u0438\u043D\u043E\u0447\u043D\u044B\
  \u0445 (`'`) \u0438\u043B\u0438 \u0434\u0432\u043E\u0439\u043D\u044B\u0445 (`\"\
  `) \u043A\u0430\u0432\u044B\u0447\u0435\u043A, \u043A\u043E\u0442\u043E\u0440\u044B\
  \u0435 \u043C\u043E\u0433\u0443\u0442 \u0437\u0430\u043A\u043B\u044E\u0447\u0430\
  \u0442\u044C \u0432 \u0441\u0435\u0431\u0435 \u0438\u043B\u0438 \u0431\u044B\u0442\
  \u044C\u2026"
title: "\u0423\u0434\u0430\u043B\u0435\u043D\u0438\u0435 \u043A\u0430\u0432\u044B\u0447\
  \u0435\u043A \u0438\u0437 \u0441\u0442\u0440\u043E\u043A\u0438"
---

{{< edit_this_page >}}

## Что и Почему?

Удаление кавычек из строки в VBA включает в себя удаление экземпляров одиночных (`'`) или двойных (`"`) кавычек, которые могут заключать в себе или быть встроенными в строку. Эта операция необходима для санации данных, чтобы убедиться, что строки корректно форматированы для запросов в базу данных, разбора JSON или просто ради эстетики или единообразия интерфейса приложения.

## Как это сделать:

В VBA существует несколько подходов к удалению кавычек из строки. Вот простой пример с использованием функции `Replace`, которая ищет определенную подстроку (в данном случае, кавычку) в строке и заменяет ее на другую подстроку (пустую строку, если нужно удалить).

```basic
Sub RemoveQuotesExample()
    Dim originalString As String
    originalString = "'This' is a ""test"" string."
    
    ' Удаление одиночных кавычек
    originalString = Replace(originalString, "'", "")
    
    ' Удаление двойных кавычек
    originalString = Replace(originalString, Chr(34), "")
    
    Debug.Print originalString 'Вывод: This is a test string.
End Sub
```

Обратите внимание, что для двойных кавычек мы используем `Chr(34)`, потому что двойная кавычка является символом ASCII 34. Это необходимо, поскольку двойные кавычки также используются для обозначения строковых литералов в VBA.

Для более тонких сценариев, когда кавычки могут быть частью необходимого форматирования (например, внутри закавыченного слова), может потребоваться более сложная логика, возможно, с использованием Regex или посимвольного разбора.

## Погружение

VBA, будучи основным инструментом для автоматизации задач в пакете Microsoft Office, предлагает богатый набор функций для манипуляции со строками, среди которых `Replace` является одной из наиболее часто используемых. Однако эта функция лишь касается поверхности того, что можно достичь с помощью VBA в плане манипуляции со строками.

Исторически VBA, перенимая от своих предшественников акцент на простоте для задач автоматизации офиса, предлагает простую реализацию функций вроде `Replace`. Однако для современных программных задач, особенно связанных со сложной манипуляцией с строками или санацией, VBA может показать свои ограничения.

В таких случаях программисты могут прибегать к комбинированию VBA с регулярными выражениями (через объект `VBScript_RegExp_55.RegExp`) для большей гибкости и мощи при разборе и манипуляции со строками. Однако этот подход вводит дополнительную сложность и требует твердого понимания шаблонов regex, что может не подойти всем пользователям.

Несмотря на свои ограничения, функция `Replace` в VBA эффективно справляется с многими распространенными сценариями удаления кавычек из строк. Она служит быстрым и простым решением для большинства потребностей манипуляции со строками, не углубляясь в более сложную область regex. Для тех, кто сталкивается с пределами возможностей `Replace` и других базовых функций работы со строками, изучение regex внутри VBA или рассмотрение более мощного языка, специально предназначенного для сложных операций со строками, может стать следующим шагом.
