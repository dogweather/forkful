---
changelog:
- 2024-02-01, gpt-4-0125-preview, translated from English
date: 2024-02-01 22:01:16.209613-07:00
description: "\u041E\u043A\u0440\u0443\u0433\u043B\u0435\u043D\u0438\u0435 \u0447\u0438\
  \u0441\u0435\u043B \u0432 \u043F\u0440\u043E\u0433\u0440\u0430\u043C\u043C\u0438\
  \u0440\u043E\u0432\u0430\u043D\u0438\u0438 \u0441\u0432\u044F\u0437\u0430\u043D\u043E\
  \ \u0441 \u043F\u0440\u0438\u0431\u043B\u0438\u0436\u0435\u043D\u0438\u0435\u043C\
  \ \u0447\u0438\u0441\u043B\u0430 \u043A \u0431\u043B\u0438\u0436\u0430\u0439\u0448\
  \u0435\u043C\u0443 \u0446\u0435\u043B\u043E\u043C\u0443 \u0447\u0438\u0441\u043B\
  \u0443 \u0438\u043B\u0438 \u043A \u043E\u043F\u0440\u0435\u0434\u0435\u043B\u0435\
  \u043D\u043D\u043E\u043C\u0443 \u043A\u043E\u043B\u0438\u0447\u0435\u0441\u0442\u0432\
  \u0443 \u0434\u0435\u0441\u044F\u0442\u0438\u0447\u043D\u044B\u0445 \u0437\u043D\
  \u0430\u043A\u043E\u0432. \u041F\u0440\u043E\u0433\u0440\u0430\u043C\u043C\u0438\
  \u0441\u0442\u044B\u2026"
lastmod: '2024-03-13T22:44:44.733214-06:00'
model: gpt-4-0125-preview
summary: "\u041E\u043A\u0440\u0443\u0433\u043B\u0435\u043D\u0438\u0435 \u0447\u0438\
  \u0441\u0435\u043B \u0432 \u043F\u0440\u043E\u0433\u0440\u0430\u043C\u043C\u0438\
  \u0440\u043E\u0432\u0430\u043D\u0438\u0438 \u0441\u0432\u044F\u0437\u0430\u043D\u043E\
  \ \u0441 \u043F\u0440\u0438\u0431\u043B\u0438\u0436\u0435\u043D\u0438\u0435\u043C\
  \ \u0447\u0438\u0441\u043B\u0430 \u043A \u0431\u043B\u0438\u0436\u0430\u0439\u0448\
  \u0435\u043C\u0443 \u0446\u0435\u043B\u043E\u043C\u0443 \u0447\u0438\u0441\u043B\
  \u0443 \u0438\u043B\u0438 \u043A \u043E\u043F\u0440\u0435\u0434\u0435\u043B\u0435\
  \u043D\u043D\u043E\u043C\u0443 \u043A\u043E\u043B\u0438\u0447\u0435\u0441\u0442\u0432\
  \u0443 \u0434\u0435\u0441\u044F\u0442\u0438\u0447\u043D\u044B\u0445 \u0437\u043D\
  \u0430\u043A\u043E\u0432. \u041F\u0440\u043E\u0433\u0440\u0430\u043C\u043C\u0438\
  \u0441\u0442\u044B\u2026"
title: "\u041E\u043A\u0440\u0443\u0433\u043B\u0435\u043D\u0438\u0435 \u0447\u0438\u0441\
  \u0435\u043B"
weight: 13
---

## Что и Почему?

Округление чисел в программировании связано с приближением числа к ближайшему целому числу или к определенному количеству десятичных знаков. Программисты округляют числа для упрощения фигур, улучшения читаемости или для выполнения конкретных числовых критериев в расчетах, особенно в финансовых вычислениях, где точность имеет значение.

## Как:

В Visual Basic for Applications (VBA) для округления можно использовать несколько функций, каждая из которых подходит для конкретных сценариев. Вот наиболее часто используемые функции с примерами:

1. **Функция Round**:
   Функция `Round` округляет число до указанного количества цифр.
   ```basic
   Dim roundedNumber As Double
   roundedNumber = Round(3.14159, 2)  ' Вывод: 3.14
   MsgBox roundedNumber
   ```
   
2. **Функции Int и Fix**:
   Функции `Int` и `Fix` используются для округления чисел в меньшую сторону до ближайшего целого, но они по-разному ведут себя с отрицательными числами.
   ```basic
   Dim intRounded As Integer
   Dim fixRounded As Integer
   
   intRounded = Int(-3.14159)  ' Вывод: -4
   fixRounded = Fix(-3.14159)  ' Вывод: -3
   
   MsgBox "Int: " & intRounded & ", Fix: " & fixRounded
   ```

3. **Функции Ceiling и Floor**:
   В VBA нет встроенных функций `Ceiling` и `Floor`, которые есть в других языках. Для имитации используйте `Application.WorksheetFunction.Ceiling_Math` и `Application.WorksheetFunction.Floor_Math` для Excel VBA.
   ```basic
   Dim ceilingNumber As Double
   Dim floorNumber As Double
   
   ceilingNumber = Application.WorksheetFunction.Ceiling_Math(3.14159)  ' Вывод: 4
   floorNumber = Application.WorksheetFunction.Floor_Math(3.14159)  ' Вывод: 3
   
   MsgBox "Ceiling: " & ceilingNumber & ", Floor: " & floorNumber
   ```

## Глубокое погружение

Функция `Round` в VBA принципиально отличается от методов округления в других языках из-за использования **Банковского округления**. Банковское округление осуществляется до ближайшего четного числа, когда значение находится ровно посередине между двумя числами, что снижает предвзятость в вычислениях на большом наборе данных и обеспечивает более статистически значимый результат. Однако это может привести к неожиданному поведению для тех, кто не знаком с ним, особенно когда в каждом случае ожидается точность до целых чисел.

В отличие от многих языков программирования и систем, использующих "арифметическое округление" или "округление к ближайшему большему", где число, точно находящееся посередине между двумя возможными округленными значениями, всегда округляется в большую сторону. При переводе или переносе кода с других языков на VBA программисты должны учитывать эти различия, чтобы избежать тонких ошибок или неточностей в финансовых и статистических приложениях.

Хотя VBA предлагает разнообразие функций для округления, отсутствие функций `Ceiling` и `Floor` (без использования WorksheetFunction Excel) подчеркивает ограничение в его встроенных возможностях. Программистам, пришедшим из более функционально насыщенных языков, эти пробелы могут показаться неудобными и может потребоваться реализация собственных решений или адаптация их расчетов для использования доступных функций. Несмотря на эти ограничения, правильное понимание и использование функций округления в VBA могут помочь обеспечить точность численных вычислений и соответствие требованиям большинства приложений.
