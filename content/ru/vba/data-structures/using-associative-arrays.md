---
changelog:
- 2024-02-01, gpt-4-0125-preview, translated from English
date: 2024-02-01 22:04:39.321408-07:00
description: "\u0410\u0441\u0441\u043E\u0446\u0438\u0430\u0442\u0438\u0432\u043D\u044B\
  \u0435 \u043C\u0430\u0441\u0441\u0438\u0432\u044B, \u0447\u0430\u0441\u0442\u043E\
  \ \u043D\u0430\u0437\u044B\u0432\u0430\u0435\u043C\u044B\u0435 \u0441\u043B\u043E\
  \u0432\u0430\u0440\u044F\u043C\u0438 \u0432 Visual Basic \u0434\u043B\u044F \u043F\
  \u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u0439 (VBA), \u043F\u043E\u0437\
  \u0432\u043E\u043B\u044F\u044E\u0442 \u043F\u0440\u043E\u0433\u0440\u0430\u043C\u043C\
  \u0438\u0441\u0442\u0430\u043C \u0441\u043E\u0437\u0434\u0430\u0432\u0430\u0442\u044C\
  \ \u043A\u043E\u043B\u043B\u0435\u043A\u0446\u0438\u0438 \u043F\u0430\u0440 \u043A\
  \u043B\u044E\u0447-\u0437\u043D\u0430\u0447\u0435\u043D\u0438\u0435. \u042D\u0442\
  \u0430\u2026"
lastmod: '2024-03-11T00:14:18.335699-06:00'
model: gpt-4-0125-preview
summary: "\u0410\u0441\u0441\u043E\u0446\u0438\u0430\u0442\u0438\u0432\u043D\u044B\
  \u0435 \u043C\u0430\u0441\u0441\u0438\u0432\u044B, \u0447\u0430\u0441\u0442\u043E\
  \ \u043D\u0430\u0437\u044B\u0432\u0430\u0435\u043C\u044B\u0435 \u0441\u043B\u043E\
  \u0432\u0430\u0440\u044F\u043C\u0438 \u0432 Visual Basic \u0434\u043B\u044F \u043F\
  \u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u0439 (VBA), \u043F\u043E\u0437\
  \u0432\u043E\u043B\u044F\u044E\u0442 \u043F\u0440\u043E\u0433\u0440\u0430\u043C\u043C\
  \u0438\u0441\u0442\u0430\u043C \u0441\u043E\u0437\u0434\u0430\u0432\u0430\u0442\u044C\
  \ \u043A\u043E\u043B\u043B\u0435\u043A\u0446\u0438\u0438 \u043F\u0430\u0440 \u043A\
  \u043B\u044E\u0447-\u0437\u043D\u0430\u0447\u0435\u043D\u0438\u0435. \u042D\u0442\
  \u0430\u2026"
title: "\u0418\u0441\u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u043D\u0438\u0435\
  \ \u0430\u0441\u0441\u043E\u0446\u0438\u0430\u0442\u0438\u0432\u043D\u044B\u0445\
  \ \u043C\u0430\u0441\u0441\u0438\u0432\u043E\u0432"
---

{{< edit_this_page >}}

## Что и почему?

Ассоциативные массивы, часто называемые словарями в Visual Basic для приложений (VBA), позволяют программистам создавать коллекции пар ключ-значение. Эта возможность является ключевой для эффективного хранения и извлечения данных, предлагая более гибкий и интуитивно понятный способ управления данными, чем традиционные индексы массивов.

## Как это сделать:

В VBA объект `Dictionary` предоставляет функционал, аналогичный ассоциативным массивам. Прежде всего, вам нужно добавить ссылку на Microsoft Scripting Runtime, чтобы использовать его:

1. В редакторе VBA перейти в Инструменты > Ссылки...
2. Установить флажок "Microsoft Scripting Runtime" и нажать ОК.

Вот как объявить, заполнить и получить доступ к элементам в `Dictionary`:

```vb
Dim sampleDictionary As Dictionary
Set sampleDictionary = New Dictionary

' Добавление элементов
sampleDictionary.Add Key:="Name", Item:="John Doe"
sampleDictionary.Add Key:="Age", Item:=29
sampleDictionary.Add Key:="Occupation", Item:="Engineer"

' Доступ к элементам
Debug.Print sampleDictionary.Item("Name")  ' Вывод: John Doe
Debug.Print sampleDictionary.Item("Age")   ' Вывод: 29

' Проверка существования ключа
If sampleDictionary.Exists("Occupation") Then
    Debug.Print "Ключ Occupation существует"
End If

' Удаление элементов
sampleDictionary.Remove("Occupation")

' Перебор словаря
For Each Key In sampleDictionary.Keys
    Debug.Print Key & ": " & sampleDictionary.Item(Key)
Next Key
```

## Подробнее

Объект `Dictionary` внутри взаимодействует с компонентами Windows Scripting Host. Таким образом, это позднепривязанный COM-объект, который был обычным способом расширения функциональности VBA в прошлом. Его использование в VBA может значительно улучшить способность языка манипулировать сложными наборами данных без наложения жесткой структуры, как это видно в традиционных массивах или диапазонах Excel.

Одним из ограничений, которые следует иметь в виду, является то, что доступ к `Dictionary` требует установки ссылки на Microsoft Scripting Runtime, что может усложнить распространение ваших проектов VBA. Альтернативы, такие как Коллекции, существуют в VBA, но они не имеют некоторых ключевых функций `Dictionary`, таких как возможность легко проверить существование ключа без вызова ошибки.

В более новых контекстах программирования языки вроде Python предлагают встроенную поддержку ассоциативных массивов (также известных как словари в Python) без необходимости добавления внешних ссылок. Эта встроенная поддержка упрощает процесс и предлагает более продвинутые функции "из коробки". Тем не менее, в рамках VBA и для конкретных приложений, направленных на автоматизацию задач в пакете Microsoft Office, использование объекта `Dictionary` остается мощным и актуальным методом для структур данных, подобных ассоциативным массивам.
