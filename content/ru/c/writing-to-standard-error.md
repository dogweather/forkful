---
title:                "Запись в стандартный поток ошибок"
date:                  2024-01-29T00:06:10.541738-07:00
model:                 gpt-4-0125-preview
simple_title:         "Запись в стандартный поток ошибок"

category:             "C"
tag:                  "Files and I/O"
editURL:              "https://github.com/dogweather/forkful/blob/master/content/ru/c/writing-to-standard-error.md"
changelog:
  - 2024-01-29, gpt-4-0125-preview, translated from English
---

{{< edit_this_page >}}

## Что и Почему?

Запись в стандартный поток ошибок (stderr) - это способ вывода сообщений об ошибках и диагностической информации в C. Он отделен от стандартного вывода (stdout), чтобы вы могли по-разному обрабатывать обычный вывод и вывод ошибок, например, для логирования ошибок или упрощения отладки.

## Как это сделать:

Вот как написать в stderr, используя стандартные функции библиотеки.

```C
#include <stdio.h>

int main() {
    fprintf(stderr, "Произошла ошибка!\n");
    return 0;
}
```

Пример вывода:

```
Произошла ошибка!
```

Используйте `perror`, когда хотите добавить сообщение о последней системной ошибке:

```C
#include <stdio.h>
#include <errno.h>

int main() {
    fopen("nonexistentfile.txt", "r");

    if (errno) {
        perror("Не удалось открыть файл");
    }

    return 0;
}
```

Пример вывода:

```
Не удалось открыть файл: Нет такого файла или каталога
```

## Глубокое погружение

Исторически разделение stderr от stdout помогает при запуске программ из оболочки. Стандартный вывод может быть перенаправлен в файл или другую программу, в то время как стандартная ошибка остается видимой в терминале. Это различие критически важно в системах, основанных на Unix.

Альтернативы `fprintf` или `perror` включают прямую запись в файловый дескриптор, например, `write(2, "Ошибка\n", 6);`, хотя это менее распространено, поскольку это более низкоуровнево.

Что касается реализации, stderr - это указатель `FILE`, который буферизован. Но, в отличие от stdout, обычно он устанавливается в небуферизированный режим, так что сообщения об ошибках поступают более немедленно, что ключевое для понимания проблем программы по мере их возникновения.

## Смотрите также

- [GNU C Library: Standard Streams](https://www.gnu.org/software/libc/manual/html_node/Standard-Streams.html)
- [Страница руководства для Write Syscall](https://man7.org/linux/man-pages/man2/write.2.html)
