---
title:                "Работа с XML"
aliases:
- /ru/c/working-with-xml.md
date:                  2024-02-03T18:13:26.799484-07:00
model:                 gpt-4-0125-preview
simple_title:         "Работа с XML"
tag:                  "Data Formats and Serialization"
editURL:              "https://github.com/dogweather/forkful/blob/master/content/ru/c/working-with-xml.md"
changelog:
  - 2024-02-03, gpt-4-0125-preview, translated from English
---

{{< edit_this_page >}}

## Что и Почему?

Работа с XML в C подразумевает анализ, запросы и манипуляции с документами XML с использованием различных библиотек. Программисты обращаются к XML из-за его широкого использования в веб-сервисах, файлах конфигурации и обмене данными между различными системами, что требует навыков эффективной работы с XML для разработки надежных приложений.

## Как:

C не имеет встроенной поддержки XML, поэтому вам нужно будет использовать внешние библиотеки. Одним из популярных выборов является `libxml2`, стабильная и функционально насыщенная библиотека. Вот как прочитать и разобрать XML-файл с помощью `libxml2`.

Сначала убедитесь, что у вас установлен `libxml2` на вашей системе. Возможно, вам придется установить его через менеджер пакетов (например, `apt-get install libxml2-dev` в системах Debian).

Затем подключите заголовок `libxml2` в вашу программу на C:

```c
#include <libxml/parser.h>
#include <libxml/tree.h>
```

Теперь напишем простую программу для разбора XML-файла и вывода имен элементов первого уровня:

```c
#include <stdio.h>
#include <libxml/parser.h>
#include <libxml/tree.h>

int main(void) {
    xmlDoc *документ = NULL;
    xmlNode *корневой_элемент = NULL;

    // Инициализация библиотеки и проверка возможных несоответствий ABI
    LIBXML_TEST_VERSION

    // Разбор файла и получение DOM
    документ = xmlReadFile("ваш_файл.xml", NULL, 0);

    if (документ == NULL) {
        printf("Не удалось разобрать XML-файл\n");
        return -1;
    }

    // Получение корневого элемента узла
    корневой_элемент = xmlDocGetRootElement(документ);

    for (xmlNode *текущийУзел = корневой_элемент; текущийУзел; текущийУзел = текущийУзел->next) {
        if (текущийУзел->type == XML_ELEMENT_NODE) {
            printf("Тип узла: Элемент, имя: %s\n", текущийУзел->name);
        }
    }

    // Освобождение выделенной памяти для парсера и DOM
    xmlFreeDoc(документ);

    // Очистка и проверка утечек
    xmlCleanupParser();
    xmlMemoryDump(); // Опционально

    return 0;
}
```

Чтобы скомпилировать эту программу, убедитесь, что вы связали ее с `libxml2`:

```sh
gcc -o xml_example xml_example.c $(xml2-config --cflags --libs)
```

Предполагая, что у вас есть XML файл с именем `ваш_файл.xml`, запуск скомпилированной программы должен вывести имена его элементов первого уровня.

## Погружение

Взаимодействие между C и XML - это история объединения двух кардинально разных миров: структурированный, работающий на уровне байтов процедурный парадигм C и иерархическая, многословная, ориентированная на документы модель XML. Интегрируя возможности обработки XML в программы на C, разработчики используют сильные стороны C, такие как скорость и доступ к низкоуровневой памяти, для эффективного разбора и манипуляции документами XML.

`libxml2`, разработанный в рамках проекта GNOME, выдвинулся на первое место стандарта для обработки XML в C благодаря своей полной поддержке стандартов XML и производительности. Он воплощает в себе годы разработки и вклад сообщества, делая его надежным и эффективным для большинства задач XML.

Несмотря на то что `libxml2` предлагает мощные возможности, стоит отметить, что сложность разбора и манипуляции XML может ввести значительные накладные расходы. В сценариях, где избыточность и сложность XML неоправданы, альтернативы вроде JSON могут быть предпочтительнее для обмена данными. Тем не менее, для приложений или сред, где использование XML укоренилось, освоение использования `libxml2` в C открывает возможность работы с широким спектром документов XML и API, преодолевая разрыв между языком программирования C и миром обработки структурированных документов.
