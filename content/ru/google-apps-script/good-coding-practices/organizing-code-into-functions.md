---
changelog:
- 2024-02-01, gpt-4-0125-preview, translated from English
date: 2024-02-01 21:56:50.547906-07:00
description: "\u041E\u0440\u0433\u0430\u043D\u0438\u0437\u0430\u0446\u0438\u044F \u043A\
  \u043E\u0434\u0430 \u0432 \u0444\u0443\u043D\u043A\u0446\u0438\u0438 \u0437\u0430\
  \u043A\u043B\u044E\u0447\u0430\u0435\u0442\u0441\u044F \u0432 \u0441\u0442\u0440\
  \u0443\u043A\u0442\u0443\u0440\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u0438 \u0432\
  \u0430\u0448\u0435\u0433\u043E \u043A\u043E\u0434\u0430 Google Apps Script \u043F\
  \u0443\u0442\u0435\u043C \u0440\u0430\u0437\u0434\u0435\u043B\u0435\u043D\u0438\u044F\
  \ \u043B\u043E\u0433\u0438\u0447\u0435\u0441\u043A\u0438\u0445 \u0441\u0435\u0433\
  \u043C\u0435\u043D\u0442\u043E\u0432 \u043D\u0430 \u043E\u0442\u0434\u0435\u043B\
  \u044C\u043D\u044B\u0435 \u0431\u043B\u043E\u043A\u0438, \u043A\u0430\u0436\u0434\
  \u044B\u0439\u2026"
lastmod: '2024-03-13T22:44:44.201469-06:00'
model: gpt-4-0125-preview
summary: "\u041E\u0440\u0433\u0430\u043D\u0438\u0437\u0430\u0446\u0438\u044F \u043A\
  \u043E\u0434\u0430 \u0432 \u0444\u0443\u043D\u043A\u0446\u0438\u0438 \u0437\u0430\
  \u043A\u043B\u044E\u0447\u0430\u0435\u0442\u0441\u044F \u0432 \u0441\u0442\u0440\
  \u0443\u043A\u0442\u0443\u0440\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u0438 \u0432\
  \u0430\u0448\u0435\u0433\u043E \u043A\u043E\u0434\u0430 Google Apps Script \u043F\
  \u0443\u0442\u0435\u043C \u0440\u0430\u0437\u0434\u0435\u043B\u0435\u043D\u0438\u044F\
  \ \u043B\u043E\u0433\u0438\u0447\u0435\u0441\u043A\u0438\u0445 \u0441\u0435\u0433\
  \u043C\u0435\u043D\u0442\u043E\u0432 \u043D\u0430 \u043E\u0442\u0434\u0435\u043B\
  \u044C\u043D\u044B\u0435 \u0431\u043B\u043E\u043A\u0438, \u043A\u0430\u0436\u0434\
  \u044B\u0439\u2026"
title: "\u041E\u0440\u0433\u0430\u043D\u0438\u0437\u0430\u0446\u0438\u044F \u043A\u043E\
  \u0434\u0430 \u0432 \u0444\u0443\u043D\u043A\u0446\u0438\u0438"
weight: 18
---

## Что и Почему?

Организация кода в функции заключается в структурировании вашего кода Google Apps Script путем разделения логических сегментов на отдельные блоки, каждый из которых выполняет определенную задачу. Программисты делают это для повышения читаемости, удобства обслуживания и возможности повторного использования кода, обеспечивая более легкое понимание и отладку сложных скриптов.

## Как это сделать:

В Google Apps Script, который основан на JavaScript, функции определяются с использованием ключевого слова `function`, за которым следует уникальное имя функции, круглые скобки `()`, которые могут содержать параметры, и фигурные скобки `{}`, ограничивающие блок кода функции. Вот простой пример:

```javascript
function greetUser() {
  var user = Session.getActiveUser().getEmail();
  Logger.log('Привет, ' + user + '!');
}

greetUser();
```

Пример вывода:

```
Привет, someone@example.com!
```

Теперь рассмотрим более практический пример, связанный с Google Sheets, где мы разделяем функциональность на две функции: одна для настройки листа и другая для его заполнения данными.

```javascript
function setupSheet() {
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var sheet = ss.getSheets()[0];
  sheet.setName('Данные о продажах');
  sheet.appendRow(['Товар', 'Количество', 'Цена']);
}

function populateSheet(data) {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName('Данные о продажах');
  data.forEach(function(row) {
    sheet.appendRow(row);
  });
}

// Инициализируем массив данных
var salesData = [
  ['Виджеты', 15, 2.5],
  ['Гаджеты', 8, 3.75]
];

// Запускаем функции
setupSheet();
populateSheet(salesData);
```

В этом примере `setupSheet` подготавливает лист, а `populateSheet` использует массив данных о продажах для заполнения листа. Разделение этих задач делает код более чистым и более адаптируемым к изменениям.

## Углубленное изучение

Концепция разделения кода на функции не является новой или уникальной для Google Apps Script; это фундаментальная практика программирования, которую поддерживают почти все языки программирования. Исторически, функции эволюционировали из математической концепции отображения входных данных в результаты, что стало одним из основополагающих принципов структурного программирования. Этот подход способствует модульности и повторному использованию кода, предлагая четкие пути для тестирования отдельных частей скрипта.

Google Apps Script, будучи основанным на JavaScript, значительно выигрывает от функций первого класса в JavaScript, позволяющих передавать функции в качестве аргументов, возвращать их из других функций и присваивать переменным. Эта особенность открывает передовые паттерны, такие как коллбэки и функциональное программирование, хотя эти паттерны могут вносить сложность, которая может быть не нужна для простых задач автоматизации в Google Apps Script.

Для более крупных проектов или более сложных приложений разработчики могут исследовать использование новых возможностей JavaScript, таких как стрелочные функции, async/await для асинхронных операций, и даже TypeScript для статической типизации. TypeScript, в частности, может быть скомпилирован для выполнения как Google Apps Script, предоставляя разработчикам путь к более строгой проверке типов и продвинутым объектно-ориентированным функциям.

Однако, для большинства потребностей скриптинга в рамках набора приложений Google, придерживание простых, хорошо организованных функций, как показано на примерах, создает твердую основу. Всегда существует баланс между использованием передовых функций для повышения эффективности и поддержанием простоты для упрощения обслуживания и чтения кода.
