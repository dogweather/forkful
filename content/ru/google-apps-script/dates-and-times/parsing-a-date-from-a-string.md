---
changelog:
- 2024-02-01, gpt-4-0125-preview, translated from English
date: 2024-02-01 21:58:28.845368-07:00
description: "\u0420\u0430\u0437\u0431\u043E\u0440 \u0434\u0430\u0442\u044B \u0438\
  \u0437 \u0441\u0442\u0440\u043E\u043A\u0438 \u0432\u043A\u043B\u044E\u0447\u0430\
  \u0435\u0442 \u043F\u0440\u0435\u043E\u0431\u0440\u0430\u0437\u043E\u0432\u0430\u043D\
  \u0438\u0435 \u0442\u0435\u043A\u0441\u0442\u0430, \u043A\u043E\u0442\u043E\u0440\
  \u044B\u0439 \u043F\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043B\u044F\u0435\u0442\
  \ \u0434\u0430\u0442\u0443, \u0432 \u043E\u0431\u044A\u0435\u043A\u0442 \u0434\u0430\
  \u0442\u044B, \u0447\u0442\u043E \u043F\u043E\u0437\u0432\u043E\u043B\u044F\u0435\
  \u0442 \u043F\u0440\u043E\u0433\u0440\u0430\u043C\u043C\u0438\u0441\u0442\u0430\u043C\
  \ \u0432\u044B\u043F\u043E\u043B\u043D\u044F\u0442\u044C \u043E\u043F\u0435\u0440\
  \u0430\u0446\u0438\u0438, \u0441\u0432\u044F\u0437\u0430\u043D\u043D\u044B\u0435\
  \u2026"
lastmod: 2024-02-19 22:05:03.188948
model: gpt-4-0125-preview
summary: "\u0420\u0430\u0437\u0431\u043E\u0440 \u0434\u0430\u0442\u044B \u0438\u0437\
  \ \u0441\u0442\u0440\u043E\u043A\u0438 \u0432\u043A\u043B\u044E\u0447\u0430\u0435\
  \u0442 \u043F\u0440\u0435\u043E\u0431\u0440\u0430\u0437\u043E\u0432\u0430\u043D\u0438\
  \u0435 \u0442\u0435\u043A\u0441\u0442\u0430, \u043A\u043E\u0442\u043E\u0440\u044B\
  \u0439 \u043F\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043B\u044F\u0435\u0442\
  \ \u0434\u0430\u0442\u0443, \u0432 \u043E\u0431\u044A\u0435\u043A\u0442 \u0434\u0430\
  \u0442\u044B, \u0447\u0442\u043E \u043F\u043E\u0437\u0432\u043E\u043B\u044F\u0435\
  \u0442 \u043F\u0440\u043E\u0433\u0440\u0430\u043C\u043C\u0438\u0441\u0442\u0430\u043C\
  \ \u0432\u044B\u043F\u043E\u043B\u043D\u044F\u0442\u044C \u043E\u043F\u0435\u0440\
  \u0430\u0446\u0438\u0438, \u0441\u0432\u044F\u0437\u0430\u043D\u043D\u044B\u0435\
  \u2026"
title: "\u0420\u0430\u0437\u0431\u043E\u0440 \u0434\u0430\u0442\u044B \u0438\u0437\
  \ \u0441\u0442\u0440\u043E\u043A\u0438"
---

{{< edit_this_page >}}

## Что и почему?

Разбор даты из строки включает преобразование текста, который представляет дату, в объект даты, что позволяет программистам выполнять операции, связанные с датой, такие как сравнения, арифметические операции и форматирование. Это необходимо для обработки ввода пользователя, обработки данных из внешних источников и управления датами в различных форматах, особенно в приложениях, связанных с планированием, анализом данных или любыми формами записей, основанных на времени.

## Как это сделать:

В Google Apps Script, который основан на JavaScript, у вас есть несколько подходов к разбору даты из строки. Ниже приведены примеры, использующие как нативные методы JavaScript, так и утилиты Google Apps Script.

**Использование конструктора `new Date()`:**

Самый простой способ разобрать строку в дату в Google Apps Script — использование конструктора объекта `Date`. Однако это требует, чтобы строка даты была в формате, распознаваемом методом Date.parse() (например, ГГГГ-ММ-ДД).

```javascript
const dateString = '2023-04-01';
const dateObject = new Date(dateString);
Logger.log(dateObject); // Выводит Sat Apr 01 2023 00:00:00 GMT+0000 (UTC)
```

**Использование `Utilities.parseDate()`:**

Для большей гибкости, особенно с пользовательскими форматами дат, Google Apps Script предоставляет `Utilities.parseDate()`. Этот метод позволяет указать формат даты, часовой пояс и локаль.

```javascript
const dateString = '01-04-2023'; // ДД-ММ-ГГГГ
const format = 'dd-MM-yyyy';
const timezone = Session.getScriptTimeZone();
const dateObject = Utilities.parseDate(dateString, timezone, format);
Logger.log(dateObject); // Выводит Sat Apr 01 2023 00:00:00 GMT+0000 (UTC) в зависимости от часового пояса скрипта
```

Примечание: Хотя `Utilities.parseDate()` предлагает больше контроля, его поведение может варьироваться в зависимости от часового пояса скрипта, поэтому крайне важно явно указывать часовой пояс, если ваше приложение обрабатывает даты в разных регионах.

## Глубокое погружение

Разбор дат в языках программирования традиционно сопряжен с трудностями, прежде всего из-за разнообразия форматов дат и сложностей с часовыми поясами. Подход Google Apps Script, в основном заимствованный у JavaScript, стремится упростить это, предлагая как простой объект `Date`, так и более универсальную функцию `Utilities.parseDate()`. Однако каждый метод имеет свои ограничения; например, использование конструктора `Date` со строками приводит к несоответствиям в разных средах из-за различного толкования форматов дат. С другой стороны, `Utilities.parseDate()` требует более четкого понимания формата, часового пояса и локали, делая его немного более сложным, но более надежным для конкретных потребностей.

Альтернативные библиотеки или сервисы, такие как Moment.js (сейчас рекомендующий Luxon для новых проектов), предоставляют более богатые функциональные возможности и лучшее управление часовыми поясами, решая многие из этих задач. Тем не менее, в контексте Google Apps Script, где внешние библиотеки имеют ограничения, понимание и эффективное использование встроенных методов становится критически важным. Программисты, пришедшие из других языков, могут найти нюансы обработки дат в Google Apps Script уникально сложными, но могут достичь надежного разбора дат с глубоким пониманием доступных инструментов и тщательным учетом глобального характера их приложений.
