---
changelog:
- 2024-02-01, gpt-4-0125-preview, translated from English
date: 2024-02-01 22:01:56.414139-07:00
description: "\u041E\u0442\u043F\u0440\u0430\u0432\u043A\u0430 HTTP-\u0437\u0430\u043F\
  \u0440\u043E\u0441\u0430 \u0432 Google Apps Script \u0437\u0430\u043A\u043B\u044E\
  \u0447\u0430\u0435\u0442\u0441\u044F \u0432 \u043F\u0440\u043E\u0433\u0440\u0430\
  \u043C\u043C\u043D\u043E\u043C \u0441\u043E\u0437\u0434\u0430\u043D\u0438\u0438\
  \ \u0432\u044B\u0437\u043E\u0432\u0430 \u043A \u0432\u043D\u0435\u0448\u043D\u0435\
  \u043C\u0443 \u0432\u0435\u0431-\u0441\u0435\u0440\u0432\u0435\u0440\u0443 \u0438\
  \u043B\u0438 API. \u041F\u0440\u043E\u0433\u0440\u0430\u043C\u043C\u0438\u0441\u0442\
  \u044B \u0434\u0435\u043B\u0430\u044E\u0442 \u044D\u0442\u043E \u0434\u043B\u044F\
  \ \u043F\u043E\u043B\u0443\u0447\u0435\u043D\u0438\u044F\u2026"
lastmod: 2024-02-19 22:05:03.163923
model: gpt-4-0125-preview
summary: "\u041E\u0442\u043F\u0440\u0430\u0432\u043A\u0430 HTTP-\u0437\u0430\u043F\
  \u0440\u043E\u0441\u0430 \u0432 Google Apps Script \u0437\u0430\u043A\u043B\u044E\
  \u0447\u0430\u0435\u0442\u0441\u044F \u0432 \u043F\u0440\u043E\u0433\u0440\u0430\
  \u043C\u043C\u043D\u043E\u043C \u0441\u043E\u0437\u0434\u0430\u043D\u0438\u0438\
  \ \u0432\u044B\u0437\u043E\u0432\u0430 \u043A \u0432\u043D\u0435\u0448\u043D\u0435\
  \u043C\u0443 \u0432\u0435\u0431-\u0441\u0435\u0440\u0432\u0435\u0440\u0443 \u0438\
  \u043B\u0438 API. \u041F\u0440\u043E\u0433\u0440\u0430\u043C\u043C\u0438\u0441\u0442\
  \u044B \u0434\u0435\u043B\u0430\u044E\u0442 \u044D\u0442\u043E \u0434\u043B\u044F\
  \ \u043F\u043E\u043B\u0443\u0447\u0435\u043D\u0438\u044F\u2026"
title: "\u041E\u0442\u043F\u0440\u0430\u0432\u043A\u0430 HTTP-\u0437\u0430\u043F\u0440\
  \u043E\u0441\u0430"
---

{{< edit_this_page >}}

## Что и Почему?

Отправка HTTP-запроса в Google Apps Script заключается в программном создании вызова к внешнему веб-серверу или API. Программисты делают это для получения или отправки данных веб-сервисам, интегрируя огромный спектр веб-ресурсов и функциональных возможностей непосредственно в свои проекты Google Apps Script.

## Как:

В Google Apps Script основной способ отправки HTTP-запроса - использование сервиса `UrlFetchApp`. Этот сервис предоставляет методы для выполнения HTTP-запросов методом GET и POST. Вот простой пример выполнения GET-запроса для получения данных в формате JSON:

```javascript
function fetchJsonData() {
  var url = 'https://api.example.com/data';
  var response = UrlFetchApp.fetch(url);
  var json = response.getContentText();
  var data = JSON.parse(json);
  
  Logger.log(data);
}
```

Для выполнения POST-запроса, который обычно используется для отправки данных на сервер, необходимо включить дополнительные данные в параметр options:

```javascript
function postExample() {
  var url = 'https://api.example.com/post';
  var payload = {
    key1: 'value1',
    key2: 'value2'
  };
  
  var options = {
    'method' : 'post',
    'contentType': 'application/json',
    // Преобразование объекта JavaScript в строку JSON
    'payload' : JSON.stringify(payload)
  };
  
  var response = UrlFetchApp.fetch(url, options);
  Logger.log(response.getContentText());
}
```

Эти фрагменты показывают базовую реализацию выполнения GET и POST-запросов. Результат будет зависеть от ответа API и может быть просмотрен в Logger Google Apps Script.

## Погружение

Сервис `UrlFetchApp` в Google Apps Script значительно эволюционировал с момента своего создания, предлагая более тонкий контроль над HTTP-запросами с функциями, такими как задание заголовков, тела запроса и обработка multipart/form-data для загрузки файлов. Хотя он обеспечивает простой способ интеграции внешних веб-сервисов, разработчики, перешедшие на него с более мощных серверных языков, могут считать его функциональность в некоторой степени ограниченной по сравнению с библиотеками вроде `requests` в Python или `fetch` API в Node.js.

Одно из заметных ограничений - это лимит времени выполнения для Google Apps Script, который влияет на длительные запросы. Кроме того, несмотря на то, что `UrlFetchApp` охватывает широкий спектр сценариев использования, более сложные ситуации, включающие аутентификацию OAuth или обработку очень больших массивов данных, могут требовать нестандартных решений или использования дополнительных ресурсов Google Cloud.

Тем не менее, для большинства интеграций, с которыми сталкиваются разработчики Google Workspace, начиная от автоматизации получения данных и заканчивая публикацией обновлений во внешних сервисах, `UrlFetchApp` представляет собой мощный, доступный инструмент. Его интеграция в Google Apps Script означает, что нет необходимости во внешних библиотеках или сложной настройке, что делает выполнение HTTP-запросов относительно простым в рамках ограничений Google Apps Script. Поскольку ландшафт веб-API продолжает расширяться, `UrlFetchApp` остается критическим мостом для программ Google Apps Script для взаимодействия с миром за пределами экосистемы Google.
