---
changelog:
- 2024-02-01, gpt-4-0125-preview, translated from English
date: 2024-02-01 22:05:16.091170-07:00
description: "\u0420\u0435\u0433\u0443\u043B\u044F\u0440\u043D\u044B\u0435 \u0432\u044B\
  \u0440\u0430\u0436\u0435\u043D\u0438\u044F (regex) \u2014 \u044D\u0442\u043E \u0448\
  \u0430\u0431\u043B\u043E\u043D\u044B, \u0438\u0441\u043F\u043E\u043B\u044C\u0437\
  \u0443\u0435\u043C\u044B\u0435 \u0434\u043B\u044F \u043F\u043E\u0438\u0441\u043A\
  \u0430 \u0441\u043E\u0447\u0435\u0442\u0430\u043D\u0438\u0439 \u0441\u0438\u043C\
  \u0432\u043E\u043B\u043E\u0432 \u0432 \u0441\u0442\u0440\u043E\u043A\u0430\u0445\
  . \u041F\u0440\u043E\u0433\u0440\u0430\u043C\u043C\u0438\u0441\u0442\u044B \u0438\
  \u0441\u043F\u043E\u043B\u044C\u0437\u0443\u044E\u0442 \u0438\u0445 \u0434\u043B\
  \u044F \u043F\u043E\u0438\u0441\u043A\u0430, \u0440\u0435\u0434\u0430\u043A\u0442\
  \u0438\u0440\u043E\u0432\u0430\u043D\u0438\u044F\u2026"
lastmod: '2024-02-25T18:49:41.930328-07:00'
model: gpt-4-0125-preview
summary: "\u0420\u0435\u0433\u0443\u043B\u044F\u0440\u043D\u044B\u0435 \u0432\u044B\
  \u0440\u0430\u0436\u0435\u043D\u0438\u044F (regex) \u2014 \u044D\u0442\u043E \u0448\
  \u0430\u0431\u043B\u043E\u043D\u044B, \u0438\u0441\u043F\u043E\u043B\u044C\u0437\
  \u0443\u0435\u043C\u044B\u0435 \u0434\u043B\u044F \u043F\u043E\u0438\u0441\u043A\
  \u0430 \u0441\u043E\u0447\u0435\u0442\u0430\u043D\u0438\u0439 \u0441\u0438\u043C\
  \u0432\u043E\u043B\u043E\u0432 \u0432 \u0441\u0442\u0440\u043E\u043A\u0430\u0445\
  . \u041F\u0440\u043E\u0433\u0440\u0430\u043C\u043C\u0438\u0441\u0442\u044B \u0438\
  \u0441\u043F\u043E\u043B\u044C\u0437\u0443\u044E\u0442 \u0438\u0445 \u0434\u043B\
  \u044F \u043F\u043E\u0438\u0441\u043A\u0430, \u0440\u0435\u0434\u0430\u043A\u0442\
  \u0438\u0440\u043E\u0432\u0430\u043D\u0438\u044F\u2026"
title: "\u0418\u0441\u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u043D\u0438\u0435\
  \ \u0440\u0435\u0433\u0443\u043B\u044F\u0440\u043D\u044B\u0445 \u0432\u044B\u0440\
  \u0430\u0436\u0435\u043D\u0438\u0439"
---

{{< edit_this_page >}}

## Что и Почему?

Регулярные выражения (regex) — это шаблоны, используемые для поиска сочетаний символов в строках. Программисты используют их для поиска, редактирования или манипулирования текстом и данными, что делает их незаменимыми для задач поиска образцов и анализа данных.

## Как:

Использование регулярных выражений в Google Apps Script довольно простое благодаря синтаксису, основанному на JavaScript. Вот как вы можете включить regex в ваши скрипты для распространенных задач, таких как поиск и валидация данных.

### Поиск в строках

Предположим, вы хотите найти в строке определенный шаблон, например, адрес электронной почты. Вот простой пример:

```javascript
function findEmailInText(text) {
  var emailPattern = /\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b/;
  var found = text.match(emailPattern);
  if (found) {
    Logger.log("Найдено: " + found[0]);
  } else {
    Logger.log("Электронная почта не найдена.");
  }
}

// Пример использования
findEmailInText("Свяжитесь с нами по адресу info@example.com.");
```

### Проверка данных

Регулярные выражения отлично подходят для валидации данных. Ниже приведена функция, которая проверяет входную строку на соответствие простой политике пароля (как минимум одна заглавная буква, одна строчная буква и минимум 8 символов).

```javascript
function validatePassword(password) {
  var passwordPattern = /^(?=.*[a-z])(?=.*[A-Z]).{8,}$/;
  return passwordPattern.test(password);
}

// Пример вывода
Logger.log(validatePassword("Str0ngPass")); // Выводит: true
Logger.log(validatePassword("weak"));       // Выводит: false
```

## Углубленное изучение

Регулярные выражения в Google Apps Script унаследованы от JavaScript, впервые стандартизированные в спецификации языка ECMAScript в июне 1997 года. Несмотря на их мощь, иногда они могут привести к путаному и трудно поддерживаемому коду, особенно при чрезмерном использовании или для выполнения сложных задач соответствия шаблонов, которые могут быть более эффективно решены другими методами анализа.

Например, хотя вы можете использовать regex для разбора HTML или XML на скорую руку, делать это, как правило, не рекомендуется из-за вложенных и сложных структур этих документов. Вместо этого инструменты, специально предназначенные для анализа таких структур, такие как DOM-парсеры для HTML, являются более надежными и удобочитаемыми.

Более того, разработчикам Google Apps Script следует быть внимательными к возможным проблемам производительности при использовании сложных шаблонов regex в задачах масштабной манипуляции текстом, поскольку обработка regex может быть ресурсоемкой. В таких случаях разделение задачи на более простые подзадачи или использование встроенных функций манипуляции строк могут предложить лучший баланс производительности и поддерживаемости.
